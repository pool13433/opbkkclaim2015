/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.claim.ui;

import com.claim.controller.LogAppController;
import com.claim.controller.OpReferController;
import com.claim.dao.OppDAO;
import com.claim.object.HospitalService;
import com.claim.object.OppReport;
import com.claim.object.Stmp;
import com.claim.support.BaseFunction;
import com.claim.support.Console;
import com.claim.support.Constants;
import com.claim.support.NetUtils;
import com.claim.support.ProgrameStatus;
import com.claim.support.waitFrm;
import java.io.File;
import java.net.UnknownHostException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

/**
 *
 * @author Poolsawat.a
 */
public class UiReportRefer extends javax.swing.JInternalFrame {

    /**
     * Creates new form UiReportRefer
     */
    public static int PROCESS = 0;
    OpReferController referController;
    private OppDAO dAO;
    List<HospitalService> listSelectHospital = null;
    List<Stmp> listStmpRefer = null;
    BaseFunction baseFunction;

    public UiReportRefer() {
        initComponents();
        referController = new OpReferController();
        dAO = new OppDAO();
        listSelectHospital = new ArrayList<HospitalService>();
        listStmpRefer = new ArrayList<Stmp>();
        baseFunction = new BaseFunction();

        this.loadCombo();

        PROCESS = 1;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        rGroupReferType = new javax.swing.ButtonGroup();
        rGroupReferHospital = new javax.swing.ButtonGroup();
        rGroupReferCategory = new javax.swing.ButtonGroup();
        rGroupReferAttribute = new javax.swing.ButtonGroup();
        rGroupReferForUse = new javax.swing.ButtonGroup();
        tabOpRefer = new javax.swing.JPanel();
        jPanel26 = new javax.swing.JPanel();
        jPanel27 = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        comboYearOpRefer = new javax.swing.JComboBox();
        jLabel8 = new javax.swing.JLabel();
        comboNumOpRefer = new javax.swing.JComboBox();
        jPanel28 = new javax.swing.JPanel();
        radioDetailOpRefer = new javax.swing.JRadioButton();
        radioSumOpRefer = new javax.swing.JRadioButton();
        jPanel29 = new javax.swing.JPanel();
        radioAllHospitalOpRefer = new javax.swing.JRadioButton();
        radioSingleHospitalOpRefer = new javax.swing.JRadioButton();
        btnReferChooseHospital = new javax.swing.JButton();
        jScrollPane11 = new javax.swing.JScrollPane();
        txtHnameOpaeRefer = new javax.swing.JTextArea();
        jPanel30 = new javax.swing.JPanel();
        btnReferPathFile = new javax.swing.JButton();
        txtPathFileOpRefer = new javax.swing.JTextField();
        btnReferPathFileDesktop = new javax.swing.JButton();
        jPanel31 = new javax.swing.JPanel();
        radioDeductOpRefer = new javax.swing.JRadioButton();
        radioPaymentOpRefer = new javax.swing.JRadioButton();
        jPanel32 = new javax.swing.JPanel();
        radioAttributeSingleOpRefer = new javax.swing.JRadioButton();
        radioAttributeAllOpRefer = new javax.swing.JRadioButton();
        radioAttributeOpRefer = new javax.swing.JRadioButton();
        jPanel35 = new javax.swing.JPanel();
        txtTitleTimeRefer = new javax.swing.JTextField();
        jPanel45 = new javax.swing.JPanel();
        radio_special_refer_1 = new javax.swing.JRadioButton();
        radio_special_refer_all = new javax.swing.JRadioButton();
        jPanel1 = new javax.swing.JPanel();
        btnReferGenReport = new javax.swing.JButton();
        btnReferGenReportAllFunction = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        radioForUse_Genaral = new javax.swing.JRadioButton();
        radioForUse_Website = new javax.swing.JRadioButton();
        jPanel3 = new javax.swing.JPanel();
        comboLookupYear = new javax.swing.JComboBox();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("หน้าจอออกรายงาน refer");
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Excel-icon.png"))); // NOI18N
        setPreferredSize(new java.awt.Dimension(1200, 550));
        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameClosed(evt);
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
            }
        });

        tabOpRefer.setPreferredSize(new java.awt.Dimension(1000, 550));
        tabOpRefer.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel27.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "งวดการจ่ายเงิน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        jLabel7.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel7.setText("ปีเดือน");

        comboYearOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        comboYearOpRefer.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboYearOpReferItemStateChanged(evt);
            }
        });

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel8.setText("งวดที่");

        comboNumOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        comboNumOpRefer.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboNumOpReferItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel27Layout = new javax.swing.GroupLayout(jPanel27);
        jPanel27.setLayout(jPanel27Layout);
        jPanel27Layout.setHorizontalGroup(
            jPanel27Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel27Layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 86, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboYearOpRefer, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(21, 21, 21)
                .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 51, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboNumOpRefer, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(35, Short.MAX_VALUE))
        );
        jPanel27Layout.setVerticalGroup(
            jPanel27Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel27Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel27Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel27Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel8)
                        .addComponent(comboNumOpRefer, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel27Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel7)
                        .addComponent(comboYearOpRefer, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(17, Short.MAX_VALUE))
        );

        jPanel28.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "รูปแบบ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroupReferType.add(radioDetailOpRefer);
        radioDetailOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioDetailOpRefer.setSelected(true);
        radioDetailOpRefer.setText("รายงานแบบรายละเอียด");

        rGroupReferType.add(radioSumOpRefer);
        radioSumOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioSumOpRefer.setText("รายงานแบบสรุป");
        radioSumOpRefer.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSumOpReferItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel28Layout = new javax.swing.GroupLayout(jPanel28);
        jPanel28.setLayout(jPanel28Layout);
        jPanel28Layout.setHorizontalGroup(
            jPanel28Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel28Layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(radioDetailOpRefer)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(radioSumOpRefer)
                .addContainerGap(14, Short.MAX_VALUE))
        );
        jPanel28Layout.setVerticalGroup(
            jPanel28Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel28Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel28Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioDetailOpRefer)
                    .addComponent(radioSumOpRefer))
                .addContainerGap(18, Short.MAX_VALUE))
        );

        jPanel29.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "หน่วยให้บริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel29.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        rGroupReferHospital.add(radioAllHospitalOpRefer);
        radioAllHospitalOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioAllHospitalOpRefer.setText("หน่วยให้บริการทั้งหมด");
        radioAllHospitalOpRefer.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioAllHospitalOpReferItemStateChanged(evt);
            }
        });
        jPanel29.add(radioAllHospitalOpRefer, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 40, -1, -1));

        rGroupReferHospital.add(radioSingleHospitalOpRefer);
        radioSingleHospitalOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioSingleHospitalOpRefer.setText("เลือกบางหน่วยให้บริการ");
        radioSingleHospitalOpRefer.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSingleHospitalOpReferItemStateChanged(evt);
            }
        });
        jPanel29.add(radioSingleHospitalOpRefer, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 80, -1, -1));

        btnReferChooseHospital.setText("เลือก");
        btnReferChooseHospital.setEnabled(false);
        btnReferChooseHospital.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnReferChooseHospitalActionPerformed(evt);
            }
        });
        jPanel29.add(btnReferChooseHospital, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 80, -1, -1));

        jScrollPane11.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        jScrollPane11.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);

        txtHnameOpaeRefer.setColumns(20);
        txtHnameOpaeRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        txtHnameOpaeRefer.setLineWrap(true);
        txtHnameOpaeRefer.setRows(5);
        txtHnameOpaeRefer.setEnabled(false);
        jScrollPane11.setViewportView(txtHnameOpaeRefer);

        jPanel29.add(jScrollPane11, new org.netbeans.lib.awtextra.AbsoluteConstraints(310, 20, 550, 90));

        jPanel30.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "สถานที่เก็บไฟล์", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        btnReferPathFile.setText("เลือก");
        btnReferPathFile.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnReferPathFileActionPerformed(evt);
            }
        });

        txtPathFileOpRefer.setEnabled(false);

        btnReferPathFileDesktop.setText("desktop");
        btnReferPathFileDesktop.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnReferPathFileDesktopjButtonFolderActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel30Layout = new javax.swing.GroupLayout(jPanel30);
        jPanel30.setLayout(jPanel30Layout);
        jPanel30Layout.setHorizontalGroup(
            jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel30Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(btnReferPathFileDesktop)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnReferPathFile)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtPathFileOpRefer)
                .addContainerGap())
        );
        jPanel30Layout.setVerticalGroup(
            jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel30Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnReferPathFile)
                    .addComponent(txtPathFileOpRefer, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnReferPathFileDesktop))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel31.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ประเภท", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroupReferCategory.add(radioDeductOpRefer);
        radioDeductOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioDeductOpRefer.setText("หักเงิน");
        radioDeductOpRefer.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioDeductOpReferItemStateChanged(evt);
            }
        });

        rGroupReferCategory.add(radioPaymentOpRefer);
        radioPaymentOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioPaymentOpRefer.setText("จ่ายเงิน");
        radioPaymentOpRefer.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioPaymentOpReferItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel31Layout = new javax.swing.GroupLayout(jPanel31);
        jPanel31.setLayout(jPanel31Layout);
        jPanel31Layout.setHorizontalGroup(
            jPanel31Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel31Layout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addComponent(radioDeductOpRefer)
                .addGap(18, 18, 18)
                .addComponent(radioPaymentOpRefer)
                .addContainerGap(20, Short.MAX_VALUE))
        );
        jPanel31Layout.setVerticalGroup(
            jPanel31Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel31Layout.createSequentialGroup()
                .addGap(11, 11, 11)
                .addGroup(jPanel31Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioPaymentOpRefer)
                    .addComponent(radioDeductOpRefer))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel32.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ลักษณะหน่วยบริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroupReferAttribute.add(radioAttributeSingleOpRefer);
        radioAttributeSingleOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioAttributeSingleOpRefer.setSelected(true);
        radioAttributeSingleOpRefer.setText("เดี่ยว");

        rGroupReferAttribute.add(radioAttributeAllOpRefer);
        radioAttributeAllOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioAttributeAllOpRefer.setText("เครือ");

        rGroupReferAttribute.add(radioAttributeOpRefer);
        radioAttributeOpRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        radioAttributeOpRefer.setText("ทั้งหมด");

        javax.swing.GroupLayout jPanel32Layout = new javax.swing.GroupLayout(jPanel32);
        jPanel32.setLayout(jPanel32Layout);
        jPanel32Layout.setHorizontalGroup(
            jPanel32Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel32Layout.createSequentialGroup()
                .addGap(11, 11, 11)
                .addComponent(radioAttributeSingleOpRefer)
                .addGap(18, 18, 18)
                .addComponent(radioAttributeAllOpRefer)
                .addGap(18, 18, 18)
                .addComponent(radioAttributeOpRefer)
                .addContainerGap(26, Short.MAX_VALUE))
        );
        jPanel32Layout.setVerticalGroup(
            jPanel32Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel32Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel32Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioAttributeAllOpRefer)
                    .addComponent(radioAttributeSingleOpRefer)
                    .addComponent(radioAttributeOpRefer))
                .addContainerGap(13, Short.MAX_VALUE))
        );

        jPanel35.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ตัวอย่างแสดงงวด หัวรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel35.setPreferredSize(new java.awt.Dimension(972, 83));

        txtTitleTimeRefer.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N

        javax.swing.GroupLayout jPanel35Layout = new javax.swing.GroupLayout(jPanel35);
        jPanel35.setLayout(jPanel35Layout);
        jPanel35Layout.setHorizontalGroup(
            jPanel35Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel35Layout.createSequentialGroup()
                .addContainerGap(11, Short.MAX_VALUE)
                .addComponent(txtTitleTimeRefer, javax.swing.GroupLayout.PREFERRED_SIZE, 778, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(79, 79, 79))
        );
        jPanel35Layout.setVerticalGroup(
            jPanel35Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel35Layout.createSequentialGroup()
                .addComponent(txtTitleTimeRefer, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 14, Short.MAX_VALUE))
        );

        jPanel45.setBackground(new java.awt.Color(255, 208, 208));
        jPanel45.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "พิเศษ รายละเอียด", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        radio_special_refer_1.setBackground(new java.awt.Color(168, 226, 251));
        radio_special_refer_1.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N
        radio_special_refer_1.setSelected(true);
        radio_special_refer_1.setText("1 ไฟล์ 1 hcode");

        radio_special_refer_all.setBackground(new java.awt.Color(172, 255, 113));
        radio_special_refer_all.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N
        radio_special_refer_all.setText("1 ไฟล์ แบ่ง hcode แยก sheet");

        javax.swing.GroupLayout jPanel45Layout = new javax.swing.GroupLayout(jPanel45);
        jPanel45.setLayout(jPanel45Layout);
        jPanel45Layout.setHorizontalGroup(
            jPanel45Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel45Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(radio_special_refer_1, javax.swing.GroupLayout.DEFAULT_SIZE, 110, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(radio_special_refer_all, javax.swing.GroupLayout.PREFERRED_SIZE, 203, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(107, 107, 107))
        );
        jPanel45Layout.setVerticalGroup(
            jPanel45Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel45Layout.createSequentialGroup()
                .addGroup(jPanel45Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radio_special_refer_1)
                    .addComponent(radio_special_refer_all))
                .addGap(0, 21, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel26Layout = new javax.swing.GroupLayout(jPanel26);
        jPanel26.setLayout(jPanel26Layout);
        jPanel26Layout.setHorizontalGroup(
            jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel26Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel35, javax.swing.GroupLayout.DEFAULT_SIZE, 880, Short.MAX_VALUE)
                    .addGroup(jPanel26Layout.createSequentialGroup()
                        .addComponent(jPanel28, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jPanel32, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jPanel31, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel29, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel30, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel26Layout.createSequentialGroup()
                        .addComponent(jPanel27, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jPanel45, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(5, 5, 5)))
                .addContainerGap())
        );
        jPanel26Layout.setVerticalGroup(
            jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel26Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel27, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel45, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel35, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel28, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel32, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel31, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel29, javax.swing.GroupLayout.PREFERRED_SIZE, 125, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel30, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(64, Short.MAX_VALUE))
        );

        tabOpRefer.add(jPanel26, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 0, 900, 520));

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "เครื่องมือการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel1.setPreferredSize(new java.awt.Dimension(215, 445));

        btnReferGenReport.setBackground(new java.awt.Color(153, 153, 255));
        btnReferGenReport.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnReferGenReport.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btnReferGenReport.setText("ออกรายงาน");
        btnReferGenReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnReferGenReportActionPerformed(evt);
            }
        });

        btnReferGenReportAllFunction.setBackground(new java.awt.Color(255, 204, 0));
        btnReferGenReportAllFunction.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        btnReferGenReportAllFunction.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btnReferGenReportAllFunction.setText("<html>ออกรายงานทุกอย่าง<br />+ Website</html>");
        btnReferGenReportAllFunction.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnReferGenReportAllFunctionActionPerformed(evt);
            }
        });

        jPanel2.setBackground(new java.awt.Color(255, 255, 204));
        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ใช้เพื่อ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroupReferForUse.add(radioForUse_Genaral);
        radioForUse_Genaral.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioForUse_Genaral.setSelected(true);
        radioForUse_Genaral.setText("ทั่วไป");

        rGroupReferForUse.add(radioForUse_Website);
        radioForUse_Website.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioForUse_Website.setText("อัพโหลด web site");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(radioForUse_Genaral)
                    .addComponent(radioForUse_Website))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(radioForUse_Genaral)
                .addGap(26, 26, 26)
                .addComponent(radioForUse_Website)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel3.setBackground(new java.awt.Color(255, 255, 204));
        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ข้อมูลปีการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        comboLookupYear.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboLookupYear.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "รวมทุกปีงบ", "2015", "2014", "2013", "2012", "2011", "2010" }));

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(30, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(29, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(btnReferGenReport, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel3, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnReferGenReportAllFunction, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(14, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 43, Short.MAX_VALUE)
                .addComponent(btnReferGenReport, javax.swing.GroupLayout.PREFERRED_SIZE, 47, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(33, 33, 33)
                .addComponent(btnReferGenReportAllFunction, javax.swing.GroupLayout.PREFERRED_SIZE, 45, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        tabOpRefer.add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(920, 0, 240, 450));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(tabOpRefer, javax.swing.GroupLayout.PREFERRED_SIZE, 1074, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(tabOpRefer, javax.swing.GroupLayout.PREFERRED_SIZE, 635, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void comboYearOpReferItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboYearOpReferItemStateChanged

        if (comboYearOpRefer.getItemCount() > 0 && comboNumOpRefer.getItemCount() > 0) {
            String year = comboYearOpRefer.getSelectedItem().toString();
            String month = comboNumOpRefer.getSelectedItem().toString();

            String title = baseFunction.getTitleTimeReport(year, month);
            txtTitleTimeRefer.setText(title);
        }
        comboNumOpRefer.removeAllItems();
        comboNumOpRefer.addItem("-");
        for (Stmp stmp : listStmpRefer) {
            //System.out.println("comboYearOpaeIndv.getSelectedItem()++"+comboYearOpaeIndv.getSelectedItem());
            //System.out.println("stmp.getStmpYM()++"+stmp.getStmpYM());
            if (comboYearOpRefer.getSelectedItem().equals(stmp.getStmpYM())
                    && comboNumOpRefer.getSelectedItem() != stmp.getStmpN()) {
                comboNumOpRefer.addItem(stmp.getStmpN());
            }
        }
    }//GEN-LAST:event_comboYearOpReferItemStateChanged

    private void comboNumOpReferItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboNumOpReferItemStateChanged
        if (PROCESS == 1) {
            if (comboYearOpRefer.getSelectedItem() != null && comboNumOpRefer.getSelectedItem() != null) {
                txtTitleTimeRefer.setText(baseFunction.getTitleTimeReport(comboYearOpRefer.getSelectedItem().toString(), comboNumOpRefer.getSelectedItem().toString()));
            }
        }
    }//GEN-LAST:event_comboNumOpReferItemStateChanged

    private void radioSumOpReferItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSumOpReferItemStateChanged
        if (radioSumOpRefer.isSelected()) {
            radioAllHospitalOpRefer.setSelected(true);
            radioSingleHospitalOpRefer.setEnabled(false);
            btnReferChooseHospital.setEnabled(false);
        } else {
            radioSingleHospitalOpRefer.setEnabled(true);
            //btnReferChooseHospital.setEnabled(true);
        }
    }//GEN-LAST:event_radioSumOpReferItemStateChanged

    private void radioAllHospitalOpReferItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioAllHospitalOpReferItemStateChanged
        if (radioAllHospitalOpRefer.isSelected()) {
            btnReferChooseHospital.setEnabled(false);
            //txtHCodeOpaeRefer.setText("");
            txtHnameOpaeRefer.setText("");
        } else {
            radioAllHospitalOpRefer.setEnabled(true);
        }
    }//GEN-LAST:event_radioAllHospitalOpReferItemStateChanged

    private void radioSingleHospitalOpReferItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSingleHospitalOpReferItemStateChanged
        if (radioSingleHospitalOpRefer.isSelected()) {
            btnReferChooseHospital.setEnabled(true);
        } else {
            radioSingleHospitalOpRefer.setEnabled(true);
        }
    }//GEN-LAST:event_radioSingleHospitalOpReferItemStateChanged

    private void btnReferChooseHospitalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnReferChooseHospitalActionPerformed
        txtHnameOpaeRefer.setText("");
        HashMap mapParam = new HashMap();
        mapParam.put("type", "oprefer");
        //mapParam.put("code", txtHCodeOpaeRefer);
        mapParam.put("name", txtHnameOpaeRefer);
        mapParam.put("listHospital", listSelectHospital);
        DialogService dialog = new DialogService();
        dialog.DialogServiceJInternalFrame(this, closable, mapParam);
        dialog.setVisible(true);
    }//GEN-LAST:event_btnReferChooseHospitalActionPerformed

    private void btnReferPathFileActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnReferPathFileActionPerformed
        try {
            JFileChooser fc = new JFileChooser();
            fc.setDialogTitle("Open Folder");
            fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            fc.setCurrentDirectory(new File(""));
            int result = fc.showOpenDialog(this);
            if (result == JFileChooser.APPROVE_OPTION) {
                File a = fc.getSelectedFile();
                // Path File method in this class
                String temp = a.getPath();
                txtPathFileOpRefer.setText(".");

                if (temp != null) {
                    txtPathFileOpRefer.setText(temp);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnReferPathFileActionPerformed

    private void btnReferPathFileDesktopjButtonFolderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnReferPathFileDesktopjButtonFolderActionPerformed
        try {
            String desktopPath = System.getProperty("user.home") + "\\" + "Desktop";
            System.out.println("pathDesktop==>>" + desktopPath);
            txtPathFileOpRefer.setText(desktopPath);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnReferPathFileDesktopjButtonFolderActionPerformed

    private void radioDeductOpReferItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioDeductOpReferItemStateChanged
        //        if (radioDeductOpRefer.isSelected()) {
        //            radioAttributeOpRefer.setEnabled(false);
        //        } else {
        //            radioAttributeOpRefer.setEnabled(true);
        //        }
    }//GEN-LAST:event_radioDeductOpReferItemStateChanged

    private void radioPaymentOpReferItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioPaymentOpReferItemStateChanged
        if (radioPaymentOpRefer.isSelected()) {
            radioAttributeAllOpRefer.setEnabled(false);
            radioAttributeSingleOpRefer.setEnabled(false);
            radioAttributeOpRefer.setSelected(true);
        } else {
            radioAttributeAllOpRefer.setEnabled(true);
            radioAttributeSingleOpRefer.setEnabled(true);
        }
    }//GEN-LAST:event_radioPaymentOpReferItemStateChanged

    private void btnReferGenReportActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnReferGenReportActionPerformed
        final waitFrm wait = new waitFrm();

        try {
            if (comboYearOpRefer.getSelectedIndex() != 0) { // check combo stmp year
                if (comboNumOpRefer.getSelectedIndex() != 0) { // check combo Number
                    if (radioDetailOpRefer.isSelected() || radioSumOpRefer.isSelected()) { // check radio detail || summary
                        if (radioAllHospitalOpRefer.isSelected() || radioSingleHospitalOpRefer.isSelected()) { // check รูปแบบหน่วยบริการ ฟังก์ชั้นการทำงานทั้งหมดหรือเดี่ยว
                            if (radioAllHospitalOpRefer.isSelected() || radioSingleHospitalOpRefer.isSelected() && listSelectHospital.size() > 0) {
                                if (radioDeductOpRefer.isSelected() || radioPaymentOpRefer.isSelected()) {
                                    if (radioAttributeAllOpRefer.isSelected() || radioAttributeSingleOpRefer.isSelected() || radioAttributeOpRefer.isSelected()) {
                                        if (!txtPathFileOpRefer.getText().isEmpty()) {
                                            int selectOption = JOptionPane.showConfirmDialog(null,
                                                    Constants.MSG_REPORT_CONFIRM,
                                                    Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                            if (selectOption == JOptionPane.YES_OPTION) {
                                                wait.setVisible(true);

                                                Thread thread = new Thread(new Runnable() {
                                                    @Override
                                                    public void run() {
                                                        ProgrameStatus programeStatus = new ProgrameStatus();
                                                        try {
                                                            wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                            OppReport report = setInputFormReport();
                                                            if (radioDetailOpRefer.isSelected()) { // รายละเอียด

                                                                if (radioDeductOpRefer.isSelected()) {// หัก

                                                                    if (radioAttributeSingleOpRefer.isSelected()) { //เดี่ยว
                                                                        if (radio_special_refer_1.isSelected()) {
                                                                            programeStatus = referController.refer_detailDeduct_singleClinic_1sheet1file(report);
                                                                        } else if (radio_special_refer_all.isSelected()) {
                                                                            programeStatus = referController.refer_detailDeduct_singleClinic(report);
                                                                        } else {
                                                                            System.out.println(" No Select");
                                                                        }
                                                                    } else if (radioAttributeAllOpRefer.isSelected()) { // เครือ
                                                                        if (radio_special_refer_1.isSelected()) {
                                                                            programeStatus = referController.refer_detailDeduct_clinicAndHospital_1sheet1file(report);
                                                                        } else if (radio_special_refer_all.isSelected()) {
                                                                            programeStatus = referController.refer_detailDeduct_clinicAndHospital(report);
                                                                        } else {
                                                                            System.out.println(" No Select");
                                                                        }
                                                                    } else {
                                                                        if (radio_special_refer_1.isSelected()) {
                                                                            programeStatus = referController.refer_detailDeduct_1sheet1file(report);
                                                                        } else if (radio_special_refer_all.isSelected()) {
                                                                            programeStatus = referController.refer_detailDeduct(report);
                                                                        } else {
                                                                            System.out.println(" No Select");
                                                                        }

                                                                    }
                                                                } else { // จ่าย
                                                                    if (radio_special_refer_1.isSelected()) {
                                                                        programeStatus = referController.refer_detailPayment_1sheet1file(report);
                                                                    } else if (radio_special_refer_all.isSelected()) {
                                                                        programeStatus = referController.refer_detailPayment(report);
                                                                    } else {
                                                                        System.out.println(" No Select");
                                                                    }

                                                                }
                                                                if (programeStatus.getProcessStatus()) {
                                                                    JOptionPane.showMessageDialog(UiReportRefer.this,
                                                                            programeStatus.getMessage(),
                                                                            programeStatus.getTitle(),
                                                                            JOptionPane.INFORMATION_MESSAGE);
                                                                    new BaseFunction().openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                                } else {
                                                                    JOptionPane.showMessageDialog(UiReportRefer.this,
                                                                            programeStatus.getMessage(),
                                                                            programeStatus.getTitle(),
                                                                            JOptionPane.ERROR_MESSAGE);
                                                                }
                                                            } else { // สรุป

                                                                if (radioDeductOpRefer.isSelected()) {// หัก
                                                                    if (radioAttributeSingleOpRefer.isSelected()) { //เดี่ยว
                                                                        programeStatus = referController.refer_sumDeduct_singleClinic(setInputFormReport());
                                                                    } else if (radioAttributeAllOpRefer.isSelected()) { // เครือ
                                                                        programeStatus = referController.refer_sumDeduct_clinicAndHospital(setInputFormReport());
                                                                    } else {
                                                                        programeStatus = referController.refer_sumDeduct(setInputFormReport());
                                                                    }
                                                                } else { // จ่าย

                                                                    programeStatus = referController.refer_sumPayment(setInputFormReport());
                                                                }
                                                                if (programeStatus.getProcessStatus()) {
                                                                    JOptionPane.showMessageDialog(UiReportRefer.this,
                                                                            programeStatus.getMessage(),
                                                                            programeStatus.getTitle(),
                                                                            JOptionPane.INFORMATION_MESSAGE);
                                                                    baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                                } else {
                                                                    JOptionPane.showMessageDialog(UiReportRefer.this,
                                                                            programeStatus.getMessage(),
                                                                            programeStatus.getTitle(),
                                                                            JOptionPane.ERROR_MESSAGE);
                                                                }
                                                            }
                                                            wait.setVisible(false);
                                                        } catch (Exception e) {
                                                            e.printStackTrace();
                                                        }
                                                        try {
                                                            new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน oprefer แบบ บางฟังก์ชั่นการทำงาน ", NetUtils.getIpAddress(), 1);
                                                        } catch (UnknownHostException ex) {
                                                            Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                                        }
                                                    }
                                                });
                                                thread.start();
                                            }

                                        } else {
                                            JOptionPane.showMessageDialog(this,
                                                    Constants.MSG_FILE_LOCATION_PLEASE,
                                                    Constants.MSG_FILE_LOCATION,
                                                    JOptionPane.ERROR_MESSAGE);
                                        }
                                    } else {
                                        JOptionPane.showMessageDialog(this,
                                                Constants.MSG_HOSPITAL_TYPE,
                                                Constants.MSG_SELECT_DATA,
                                                JOptionPane.ERROR_MESSAGE);
                                    }
                                } else {
                                    JOptionPane.showMessageDialog(this,
                                            Constants.MSG_REPORT_TYPE,
                                            Constants.MSG_SELECT_DATA,
                                            JOptionPane.ERROR_MESSAGE);
                                }
                            } else {
                                JOptionPane.showMessageDialog(this,
                                        Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                        Constants.MSG_SELECT_DATA,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_ATTRIBUTE,
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                Constants.MSG_REPOTR_FORMAT,
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_NO,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_DATE_PLEASE,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnReferGenReportActionPerformed

    private void btnReferGenReportAllFunctionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnReferGenReportAllFunctionActionPerformed

        try {
            final waitFrm wait = new waitFrm();
            if (comboYearOpRefer.getSelectedIndex() != 0) {
                if (comboNumOpRefer.getSelectedIndex() != 0) {
                    if (radioAllHospitalOpRefer.isSelected() || radioSingleHospitalOpRefer.isSelected()) {
                        if (radioAllHospitalOpRefer.isSelected() || radioSingleHospitalOpRefer.isSelected() && listSelectHospital.size() > 0) {
                            if (!txtPathFileOpRefer.getText().isEmpty()) {
                                int selectOption = JOptionPane.showConfirmDialog(null,
                                        Constants.MSG_REPORT_CONFIRM,
                                        Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                if (selectOption == JOptionPane.YES_OPTION) {
                                    wait.setVisible(true);

                                    Thread thread = new Thread(new Runnable() {
                                        @Override
                                        public void run() {
                                            ProgrameStatus programeStatus = new ProgrameStatus();
                                            try {
                                                wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                programeStatus = referController.refer_genReportAllFunction(setInputFormReport());
                                                if (programeStatus.getProcessStatus()) {
                                                    JOptionPane.showMessageDialog(UiReportRefer.this,
                                                            programeStatus.getMessage(),
                                                            programeStatus.getTitle(),
                                                            JOptionPane.INFORMATION_MESSAGE);
                                                    new BaseFunction().openDirectoryAutomatic(setInputFormReport().getPathFile());

                                                } else {
                                                    JOptionPane.showMessageDialog(UiReportRefer.this,
                                                            programeStatus.getMessage(),
                                                            programeStatus.getTitle(),
                                                            JOptionPane.ERROR_MESSAGE);
                                                }
                                                wait.setVisible(false);
                                            } catch (Exception e) {
                                                e.printStackTrace();
                                            }
                                            try {
                                                new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน oprefer แบบ ฟังก์ชั้นการทำงานทั้งหมด ", NetUtils.getIpAddress(), 1);
                                            } catch (UnknownHostException ex) {
                                                Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                            }
                                        }
                                    });
                                    thread.start();
                                }
                            } else {
                                JOptionPane.showMessageDialog(this,
                                        Constants.MSG_FILE_LOCATION_PLEASE,
                                        Constants.MSG_FILE_LOCATION,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                Constants.MSG_HOSPITAL_ATTRIBUTE, Constants.MSG_SELECT_DATA, JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_DATA,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_NO_FOR_PAYMENT,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnReferGenReportAllFunctionActionPerformed

    private void formInternalFrameClosed(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameClosed
        PROCESS = 0;
    }//GEN-LAST:event_formInternalFrameClosed
    public OppReport setInputFormReport() {
        OppReport report = new OppReport();        
        report.setYearMonth(comboYearOpRefer.getSelectedItem().toString());
        report.setNo(comboNumOpRefer.getSelectedItem().toString());
        report.setPathFile(txtPathFileOpRefer.getText());
        if (radioDetailOpRefer.isSelected()) {
            report.setReportType(0);
        } else {
            report.setReportType(1);
        }
        if (radioSingleHospitalOpRefer.isSelected()) {
            //report.setServiceCode(txtHCodeOpaeRefer.getText());
            report.setListServiceCode(listSelectHospital);
        }
        if (radioAttributeAllOpRefer.isSelected()) {
            report.setAttribute('A'); // All
        } else if (radioAttributeSingleOpRefer.isSelected()) {
            report.setAttribute('S'); // Single
        } else if (radioAttributeOpRefer.isSelected()) {
            report.setAttribute('N'); // Not All And Not Single
        }
        if (radioDeductOpRefer.isSelected()) {
            report.setCategory('D'); // Deduct
        } else {
            report.setCategory('P'); // payment
        }
        report.setMonth(baseFunction.subStringYearMonth(comboYearOpRefer.getSelectedItem().toString()).get("M").toString());
        report.setYear(baseFunction.subStringYearMonth(comboYearOpRefer.getSelectedItem().toString()).get("Y").toString());
        report.setTitle2(txtTitleTimeRefer.getText());
        if (radioForUse_Genaral.isSelected()) {
            report.setFor_use(0);
        } else if (radioForUse_Website.isSelected()) {
            report.setFor_use(1);
        }
        if (comboLookupYear.getSelectedIndex() == 0) {
            //report.setBudget_year("");            
        } else {
            report.setBudget_year(String.valueOf(comboLookupYear.getSelectedItem()));
        }
        report.setBudget_stmp(report.getYearMonth()+"-"+report.getNo());
        return report;
    }

    public void loadCombo() {
        try {
            //Tab Refer
            // get STmp From Table Rpt_Opbkk_refer
            comboYearOpRefer.removeAllItems();
            comboYearOpRefer.addItem("-");
            listStmpRefer = dAO.getStmpDistinct("RPT_OPBKK_OPREFER", "STMP");

            List<String> listRefer = new ArrayList<String>();

            for (int i = 0; i < listStmpRefer.size(); i++) {
                listRefer.add(listStmpRefer.get(i).getStmpYM());
            }
            Collections.sort(listRefer);
            for (String string : listRefer) {
                comboYearOpRefer.addItem(string);
            }
        } catch (SQLException e) {
            e.printStackTrace();
            Console.LOG(e.getMessage(), 0);
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnReferChooseHospital;
    private javax.swing.JButton btnReferGenReport;
    private javax.swing.JButton btnReferGenReportAllFunction;
    private javax.swing.JButton btnReferPathFile;
    private javax.swing.JButton btnReferPathFileDesktop;
    private javax.swing.JComboBox comboLookupYear;
    private javax.swing.JComboBox comboNumOpRefer;
    private javax.swing.JComboBox comboYearOpRefer;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel26;
    private javax.swing.JPanel jPanel27;
    private javax.swing.JPanel jPanel28;
    private javax.swing.JPanel jPanel29;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel30;
    private javax.swing.JPanel jPanel31;
    private javax.swing.JPanel jPanel32;
    private javax.swing.JPanel jPanel35;
    private javax.swing.JPanel jPanel45;
    private javax.swing.JScrollPane jScrollPane11;
    private javax.swing.ButtonGroup rGroupReferAttribute;
    private javax.swing.ButtonGroup rGroupReferCategory;
    private javax.swing.ButtonGroup rGroupReferForUse;
    private javax.swing.ButtonGroup rGroupReferHospital;
    private javax.swing.ButtonGroup rGroupReferType;
    private javax.swing.JRadioButton radioAllHospitalOpRefer;
    private javax.swing.JRadioButton radioAttributeAllOpRefer;
    private javax.swing.JRadioButton radioAttributeOpRefer;
    private javax.swing.JRadioButton radioAttributeSingleOpRefer;
    private javax.swing.JRadioButton radioDeductOpRefer;
    private javax.swing.JRadioButton radioDetailOpRefer;
    private javax.swing.JRadioButton radioForUse_Genaral;
    private javax.swing.JRadioButton radioForUse_Website;
    private javax.swing.JRadioButton radioPaymentOpRefer;
    private javax.swing.JRadioButton radioSingleHospitalOpRefer;
    private javax.swing.JRadioButton radioSumOpRefer;
    private javax.swing.JRadioButton radio_special_refer_1;
    private javax.swing.JRadioButton radio_special_refer_all;
    private javax.swing.JPanel tabOpRefer;
    private javax.swing.JTextArea txtHnameOpaeRefer;
    private javax.swing.JTextField txtPathFileOpRefer;
    private javax.swing.JTextField txtTitleTimeRefer;
    // End of variables declaration//GEN-END:variables
}
