/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.claim.ui;

import com.claim.controller.LogAppController;
import com.claim.controller.ThaiMedicineController;
import com.claim.dao.UtilDao;
import com.claim.object.HospitalService;
import com.claim.object.OppReport;
import com.claim.object.Stmp;
import com.claim.support.BaseFunction;
import com.claim.support.Constants;
import com.claim.support.NetUtils;
import com.claim.support.ProgrameStatus;
import com.claim.dialog.DialogWaitProcess;
import java.awt.event.ItemEvent;
import java.io.File;
import java.net.UnknownHostException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

/**
 *
 * @author Poolsawat.a
 */
public class UiReportThaiMedicineMom extends javax.swing.JInternalFrame {

    /**
     * Creates new form UiOpae74
     */
    public static int PROCESS = 0;
    ThaiMedicineController medicineController;
    List<HospitalService> listSelectHospital = null;
    List<Stmp> listStmpNoni = null;
    BaseFunction baseFunction;
    String REPORT_NAME = "แพทย์แผนไทยกรณีการบริการมารดาหลังคลอด";
    public UiReportThaiMedicineMom() {
        PROCESS = 0;
        initComponents();
        medicineController = new ThaiMedicineController();
        listSelectHospital = new ArrayList<HospitalService>();
        listStmpNoni = new ArrayList<Stmp>();
        baseFunction = new BaseFunction();
        this.txtTitle1.setText(ThaiMedicineController.HEADER_DETAIL_MOM);
        this.loadCombo();

        PROCESS = 1;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        rGroupTmdType = new javax.swing.ButtonGroup();
        rGroupTmdHospital = new javax.swing.ButtonGroup();
        rGroupTmd_special = new javax.swing.ButtonGroup();
        rGroupTmdForUse = new javax.swing.ButtonGroup();
        rGroupTmdServiceType = new javax.swing.ButtonGroup();
        tabOpae74 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        jPanel9 = new javax.swing.JPanel();
        jLabel5 = new javax.swing.JLabel();
        comboYearThaiMed = new javax.swing.JComboBox();
        jLabel9 = new javax.swing.JLabel();
        comboNumThaiMed = new javax.swing.JComboBox();
        jPanel10 = new javax.swing.JPanel();
        radioDetailThaiMed = new javax.swing.JRadioButton();
        radioSumThaiMed = new javax.swing.JRadioButton();
        jPanel11 = new javax.swing.JPanel();
        radioAllHospitalThaiMed = new javax.swing.JRadioButton();
        radioSingleHospitalThaiMed = new javax.swing.JRadioButton();
        btnThaiMedChooseHospital = new javax.swing.JButton();
        jScrollPane8 = new javax.swing.JScrollPane();
        txtHnameThaiMed = new javax.swing.JTextArea();
        jPanel12 = new javax.swing.JPanel();
        btnThaiMedPathFile = new javax.swing.JButton();
        txtPathFileThaiMed = new javax.swing.JTextField();
        btnThaiMedPathFileDesktop = new javax.swing.JButton();
        jPanel19 = new javax.swing.JPanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel3 = new javax.swing.JPanel();
        txtTitle1 = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        txtTitle2 = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        txtFooter1 = new javax.swing.JTextField();
        jPanel14 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        btnThaiMedGenReportAllFunction = new javax.swing.JButton();
        btnThaiMedGenReport = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        radioForUse_Genaral = new javax.swing.JRadioButton();
        radioForUse_Website = new javax.swing.JRadioButton();
        jPanel13 = new javax.swing.JPanel();
        comboLookupYear = new javax.swing.JComboBox();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("หน้าจอออกรายงาน กิจกรรมบริการมารดาหลังคลอด");
        setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Excel-icon.png"))); // NOI18N
        setPreferredSize(new java.awt.Dimension(1200, 570));

        tabOpae74.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel8.setPreferredSize(new java.awt.Dimension(900, 520));

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "งวดการจ่ายเงิน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 20))); // NOI18N
        jPanel9.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N

        jLabel5.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        jLabel5.setText("ปีเดือน");

        comboYearThaiMed.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboYearThaiMed.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboYearThaiMedItemStateChanged(evt);
            }
        });

        jLabel9.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        jLabel9.setText("งวดที่");

        comboNumThaiMed.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboNumThaiMed.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboNumThaiMedItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboYearThaiMed, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(30, 30, 30)
                .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboNumThaiMed, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(comboYearThaiMed, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9)
                    .addComponent(comboNumThaiMed, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 5, Short.MAX_VALUE))
        );

        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "รูปแบบ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 22))); // NOI18N

        rGroupTmdType.add(radioDetailThaiMed);
        radioDetailThaiMed.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioDetailThaiMed.setSelected(true);
        radioDetailThaiMed.setText("รายงานแบบรายละเอียด");
        radioDetailThaiMed.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioDetailThaiMedItemStateChanged(evt);
            }
        });

        rGroupTmdType.add(radioSumThaiMed);
        radioSumThaiMed.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioSumThaiMed.setText("รายงานแบบสรุป");
        radioSumThaiMed.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSumThaiMedItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(radioDetailThaiMed, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(radioSumThaiMed, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(302, 302, 302))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioDetailThaiMed)
                    .addComponent(radioSumThaiMed)))
        );

        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "หน่วยให้บริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 22))); // NOI18N
        jPanel11.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        rGroupTmdHospital.add(radioAllHospitalThaiMed);
        radioAllHospitalThaiMed.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioAllHospitalThaiMed.setSelected(true);
        radioAllHospitalThaiMed.setText("หน่วยให้บริการทั้งหมด");
        radioAllHospitalThaiMed.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioAllHospitalThaiMedItemStateChanged(evt);
            }
        });
        jPanel11.add(radioAllHospitalThaiMed, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 30, -1, -1));

        rGroupTmdHospital.add(radioSingleHospitalThaiMed);
        radioSingleHospitalThaiMed.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioSingleHospitalThaiMed.setText("เลือกบางหน่วยให้บริการ");
        radioSingleHospitalThaiMed.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSingleHospitalThaiMedItemStateChanged(evt);
            }
        });
        jPanel11.add(radioSingleHospitalThaiMed, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 70, -1, -1));

        btnThaiMedChooseHospital.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnThaiMedChooseHospital.setText("เลือก");
        btnThaiMedChooseHospital.setEnabled(false);
        btnThaiMedChooseHospital.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThaiMedChooseHospitalActionPerformed(evt);
            }
        });
        jPanel11.add(btnThaiMedChooseHospital, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 70, -1, -1));

        jScrollPane8.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        jScrollPane8.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);

        txtHnameThaiMed.setColumns(20);
        txtHnameThaiMed.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        txtHnameThaiMed.setForeground(java.awt.Color.blue);
        txtHnameThaiMed.setLineWrap(true);
        txtHnameThaiMed.setRows(5);
        txtHnameThaiMed.setEnabled(false);
        jScrollPane8.setViewportView(txtHnameThaiMed);

        jPanel11.add(jScrollPane8, new org.netbeans.lib.awtextra.AbsoluteConstraints(310, 30, 540, 70));

        jPanel12.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "สถานที่เก็บไฟล์", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 22))); // NOI18N

        btnThaiMedPathFile.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnThaiMedPathFile.setText("เลือก");
        btnThaiMedPathFile.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThaiMedPathFilejButtonFolderActionPerformed(evt);
            }
        });

        txtPathFileThaiMed.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        txtPathFileThaiMed.setEnabled(false);

        btnThaiMedPathFileDesktop.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnThaiMedPathFileDesktop.setText("desktop");
        btnThaiMedPathFileDesktop.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThaiMedPathFileDesktopjButtonFolderActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnThaiMedPathFileDesktop)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnThaiMedPathFile)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtPathFileThaiMed, javax.swing.GroupLayout.PREFERRED_SIZE, 673, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(115, 115, 115))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnThaiMedPathFile)
                    .addComponent(txtPathFileThaiMed, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnThaiMedPathFileDesktop))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel19.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ตัวอย่างแสดง หัวรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 22))); // NOI18N

        jTabbedPane1.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N

        txtTitle1.setFont(new java.awt.Font("TH SarabunPSK", 0, 18)); // NOI18N
        txtTitle1.setText("รายงานรายละเอียดกิจกรรมบริการมารดาหลังคลอด");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle1, javax.swing.GroupLayout.DEFAULT_SIZE, 801, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle1)
                .addContainerGap())
        );

        jTabbedPane1.addTab("หัวรายงานบนสุด", jPanel3);

        txtTitle2.setFont(new java.awt.Font("TH SarabunPSK", 0, 18)); // NOI18N
        txtTitle2.setEnabled(false);

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle2, javax.swing.GroupLayout.DEFAULT_SIZE, 801, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle2)
                .addContainerGap())
        );

        jTabbedPane1.addTab("หัวรายงานรอง", jPanel4);

        txtFooter1.setEnabled(false);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter1, javax.swing.GroupLayout.DEFAULT_SIZE, 801, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter1, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("ท้ายรายงาน", jPanel5);

        javax.swing.GroupLayout jPanel19Layout = new javax.swing.GroupLayout(jPanel19);
        jPanel19.setLayout(jPanel19Layout);
        jPanel19Layout.setHorizontalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane1)
                .addContainerGap())
        );
        jPanel19Layout.setVerticalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        jPanel14.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "รูปแบบการให้บริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 22))); // NOI18N

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jPanel19, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, 413, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(18, 18, 18)
                        .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap(42, Short.MAX_VALUE))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(8, 8, 8)
                .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(23, 23, 23))
        );

        tabOpae74.add(jPanel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 0, 910, 540));

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "เครื่องมือการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel1.setPreferredSize(new java.awt.Dimension(215, 445));

        btnThaiMedGenReportAllFunction.setBackground(new java.awt.Color(255, 204, 0));
        btnThaiMedGenReportAllFunction.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnThaiMedGenReportAllFunction.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btnThaiMedGenReportAllFunction.setText("<html>ออกรายงานทุกอย่าง<br />+ Website</html>");
        btnThaiMedGenReportAllFunction.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThaiMedGenReportAllFunctionActionPerformed(evt);
            }
        });

        btnThaiMedGenReport.setBackground(new java.awt.Color(153, 153, 255));
        btnThaiMedGenReport.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnThaiMedGenReport.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btnThaiMedGenReport.setText("ออกรายงาน");
        btnThaiMedGenReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThaiMedGenReportActionPerformed(evt);
            }
        });

        jPanel2.setBackground(new java.awt.Color(255, 255, 204));
        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ใช้เพื่อ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroupTmdForUse.add(radioForUse_Genaral);
        radioForUse_Genaral.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioForUse_Genaral.setSelected(true);
        radioForUse_Genaral.setText("ทั่วไป");

        rGroupTmdForUse.add(radioForUse_Website);
        radioForUse_Website.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioForUse_Website.setText("อัพโหลด web site");
        radioForUse_Website.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioForUse_WebsiteItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(radioForUse_Genaral)
                    .addComponent(radioForUse_Website))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(radioForUse_Genaral)
                .addGap(18, 18, 18)
                .addComponent(radioForUse_Website)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel13.setBackground(new java.awt.Color(255, 255, 204));
        jPanel13.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ข้อมูลปีการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        comboLookupYear.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboLookupYear.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "รวมทุกปีงบ", "2015", "2014", "2013", "2012", "2011", "2010" }));

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(24, Short.MAX_VALUE))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(29, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(btnThaiMedGenReportAllFunction, javax.swing.GroupLayout.DEFAULT_SIZE, 155, Short.MAX_VALUE)
                            .addComponent(btnThaiMedGenReport, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(0, 43, Short.MAX_VALUE))
                    .addComponent(jPanel13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 40, Short.MAX_VALUE)
                .addComponent(btnThaiMedGenReport, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(38, 38, 38)
                .addComponent(btnThaiMedGenReportAllFunction, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        tabOpae74.add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(930, 0, 230, 470));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(tabOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 1145, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(tabOpae74, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void comboYearThaiMedItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboYearThaiMedItemStateChanged
        comboNumThaiMed.removeAllItems();
        comboNumThaiMed.addItem("-");
        for (Stmp stmp : listStmpNoni) {
            if (comboYearThaiMed.getSelectedItem().equals(stmp.getStmpYM())
                    && comboNumThaiMed.getSelectedItem() != stmp.getStmpN()) {
                comboNumThaiMed.addItem(stmp.getStmpN());
            }
        }
    }//GEN-LAST:event_comboYearThaiMedItemStateChanged

    private void comboNumThaiMedItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboNumThaiMedItemStateChanged

        if (PROCESS == 1 && comboNumThaiMed.getSelectedItem() != null) {
            /*String yearmonth = comboYearNoni.getSelectedItem().toString();
             String no = comboNumNoni.getSelectedItem().toString();
             String stmp = yearmonth + "-" + no;
             if (stmp.length() == 8) {
             txtTitle2.setText(new DateUtil().convertStmpToString(yearmonth + "-" + no));
             }*/
            //txtTitle2.setText(noni2015Controller.getNoniStmpGroupBy(comboYearNoni.getSelectedItem(), comboNumNoni.getSelectedItem()));
        }
    }//GEN-LAST:event_comboNumThaiMedItemStateChanged

    private void radioAllHospitalThaiMedItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioAllHospitalThaiMedItemStateChanged
        if (radioAllHospitalThaiMed.isSelected()) {
            btnThaiMedChooseHospital.setEnabled(false);
            //txtHCodeOpae74.setText("");
            txtHnameThaiMed.setText("");
        } else {
            radioAllHospitalThaiMed.setEnabled(true);
        }
    }//GEN-LAST:event_radioAllHospitalThaiMedItemStateChanged

    private void radioSingleHospitalThaiMedItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSingleHospitalThaiMedItemStateChanged
        if (radioSingleHospitalThaiMed.isSelected()) {
            btnThaiMedChooseHospital.setEnabled(true);
        } else {
            radioSingleHospitalThaiMed.setEnabled(true);
        }
    }//GEN-LAST:event_radioSingleHospitalThaiMedItemStateChanged

    private void btnThaiMedChooseHospitalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThaiMedChooseHospitalActionPerformed
        txtHnameThaiMed.setText("");
        if (listSelectHospital.size() > 0) {
            listSelectHospital.removeAll(listSelectHospital);
            System.out.println("Clear listSelectHospital success");
        }
        HashMap mapParam = new HashMap();
        mapParam.put("type", "opae74");
        //mapParam.put("code", txtHCodeOpae74);
        mapParam.put("name", txtHnameThaiMed);
        mapParam.put("listHospital", listSelectHospital);
        DialogService dialog = new DialogService();
        dialog.DialogServiceJInternalFrame(this, true, mapParam);
        dialog.setVisible(true);
    }//GEN-LAST:event_btnThaiMedChooseHospitalActionPerformed

    private void btnThaiMedPathFilejButtonFolderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThaiMedPathFilejButtonFolderActionPerformed
        try {
            JFileChooser fc = new JFileChooser();
            fc.setDialogTitle("Open Folder");
            fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            fc.setCurrentDirectory(new File(""));
            int result = fc.showOpenDialog(this);
            if (result == JFileChooser.APPROVE_OPTION) {
                File a = fc.getSelectedFile();
                // Path File method in this class
                String temp = a.getPath();
                txtPathFileThaiMed.setText(".");

                if (temp != null) {
                    txtPathFileThaiMed.setText(temp);
                    //txtPathFileOpae74.setEnabled(true);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnThaiMedPathFilejButtonFolderActionPerformed

    private void btnThaiMedPathFileDesktopjButtonFolderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThaiMedPathFileDesktopjButtonFolderActionPerformed
        try {
            String desktopPath = System.getProperty("user.home") + "\\" + "Desktop";
            System.out.println("pathDesktop==>>" + desktopPath);
            txtPathFileThaiMed.setText(desktopPath);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnThaiMedPathFileDesktopjButtonFolderActionPerformed

    private void btnThaiMedGenReportActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThaiMedGenReportActionPerformed
        final DialogWaitProcess wait = new DialogWaitProcess();

        try {
            if (comboYearThaiMed.getSelectedIndex() != 0) {
                if (comboNumThaiMed.getSelectedIndex() != 0) {
                    if (radioDetailThaiMed.isSelected() || radioSumThaiMed.isSelected()) {
                        if (radioAllHospitalThaiMed.isSelected()
                                || radioSingleHospitalThaiMed.isSelected() && listSelectHospital.size() > 0) {
                            if (!txtPathFileThaiMed.getText().isEmpty()) {
                                int selectOption = JOptionPane.showConfirmDialog(null,
                                        Constants.MSG_REPORT_CONFIRM,
                                        Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                if (selectOption == JOptionPane.YES_OPTION) {
                                    wait.setVisible(true);

                                    Thread thread = new Thread(new Runnable() {
                                        @Override
                                        public void run() {
                                            ProgrameStatus programeStatus = new ProgrameStatus();
                                            try {
                                                wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                if (radioDetailThaiMed.isSelected()) { // รายละเอียด
                                                    programeStatus = new ThaiMedicineController().TmdDetail_ByHcode(setInputFormReport());

                                                    //action controller 
                                                    if (programeStatus.getProcessStatus()) {
                                                        JOptionPane.showMessageDialog(UiReportThaiMedicineMom.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.INFORMATION_MESSAGE);
                                                        baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                    } else {
                                                        JOptionPane.showMessageDialog(UiReportThaiMedicineMom.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.ERROR_MESSAGE);
                                                    }
                                                } else { // สรุป

                                                    programeStatus = new ThaiMedicineController().tmdMomSummary(setInputFormReport());
                                                    if (programeStatus.getProcessStatus()) {
                                                        JOptionPane.showMessageDialog(UiReportThaiMedicineMom.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.INFORMATION_MESSAGE);
                                                        baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                    } else {
                                                        JOptionPane.showMessageDialog(UiReportThaiMedicineMom.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.ERROR_MESSAGE);
                                                    }
                                                }
                                                wait.setVisible(false);
                                            } catch (Exception e) {
                                                e.printStackTrace();
                                            }
                                             /*
                                            * 17-08-2015
                                            */
                                            /*try {
                                                new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน "+REPORT_NAME+" แบบ บางฟังก์ชั่น การทำงาน ", NetUtils.getIpAddress(), 1);
                                            } catch (UnknownHostException ex) {
                                                Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                            }*/
                                        }
                                    });
                                    thread.start();
                                }

                            } else {
                                JOptionPane.showMessageDialog(this,
                                        Constants.MSG_FILE_LOCATION_PLEASE,
                                        Constants.MSG_FILE_LOCATION,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                Constants.MSG_REPOTR_FORMAT,
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_DATA,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_DATE_PLEASE,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnThaiMedGenReportActionPerformed

    private void btnThaiMedGenReportAllFunctionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThaiMedGenReportAllFunctionActionPerformed

        try {
            final DialogWaitProcess wait = new DialogWaitProcess();
            if (comboYearThaiMed.getSelectedIndex() != 0) {
                if (comboNumThaiMed.getSelectedIndex() != 0) {
                    if (radioAllHospitalThaiMed.isSelected() || radioSingleHospitalThaiMed.isSelected()) {
                        if (radioAllHospitalThaiMed.isSelected() || radioSingleHospitalThaiMed.isSelected() && listSelectHospital.size() > 0) {
                            if (!txtPathFileThaiMed.getText().isEmpty()) {
                                int selectOption = JOptionPane.showConfirmDialog(null,
                                        Constants.MSG_REPORT_CONFIRM,
                                        Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                if (selectOption == JOptionPane.YES_OPTION) {
                                    wait.setVisible(true);

                                    Thread thread = new Thread(new Runnable() {
                                        @Override
                                        public void run() {
                                            ProgrameStatus programeStatus = new ProgrameStatus();
                                            try {
                                                OppReport report = setInputFormReport();
                                                wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                programeStatus = new ThaiMedicineController().tmd_genReportAllFunction(report);
                                                if (programeStatus.getProcessStatus()) {
                                                    JOptionPane.showMessageDialog(UiReportThaiMedicineMom.this,
                                                            Constants.MSG_REPORT_SUCCESS,
                                                            Constants.MSG_REPORT_COMPLETE, JOptionPane.INFORMATION_MESSAGE);
                                                    baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());

                                                } else {
                                                    JOptionPane.showMessageDialog(UiReportThaiMedicineMom.this,
                                                            Constants.MSG_CAN_NOT_REPORT_ERROR,
                                                            Constants.MSG_PROCESS_FAILS,
                                                            JOptionPane.ERROR_MESSAGE);
                                                }
                                                wait.setVisible(false);
                                            } catch (Exception e) {
                                                e.printStackTrace();
                                            }
                                            /*
                                            * 17-08-2015
                                            */
                                            /* try {
                                                new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน "+REPORT_NAME+" แบบ ฟังก์ชั้นการทำงานทั้งหมด ", NetUtils.getIpAddress(), 1);
                                            } catch (UnknownHostException ex) {
                                                Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                            }*/
                                        }
                                    });
                                    thread.start();

                                }
                            } else {
                                JOptionPane.showMessageDialog(this,
                                        Constants.MSG_FILE_LOCATION_PLEASE,
                                        Constants.MSG_FILE_LOCATION,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                Constants.MSG_HOSPITAL_ATTRIBUTE,
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_DATA,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_NO,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnThaiMedGenReportAllFunctionActionPerformed

    private void radioForUse_WebsiteItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioForUse_WebsiteItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            comboLookupYear.setEnabled(false);
        } else {
            comboLookupYear.setEnabled(true);
        }
    }//GEN-LAST:event_radioForUse_WebsiteItemStateChanged

    private void radioDetailThaiMedItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioDetailThaiMedItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            txtTitle1.setText(ThaiMedicineController.HEADER_DETAIL_MOM);
        } else {
            txtTitle1.setText(ThaiMedicineController.HEADER_SUM_MOM);
        }
    }//GEN-LAST:event_radioDetailThaiMedItemStateChanged

    private void radioSumThaiMedItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSumThaiMedItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            txtTitle1.setText(ThaiMedicineController.HEADER_SUM_MOM);
            radioSingleHospitalThaiMed.setEnabled(false);
        } else {
            txtTitle1.setText(ThaiMedicineController.HEADER_DETAIL_MOM);
            radioSingleHospitalThaiMed.setEnabled(true);
        }
    }//GEN-LAST:event_radioSumThaiMedItemStateChanged
    public void loadCombo() {
        try {
            //Tab Opae74
            //get Stmp From Table Rpt_Opbkk_opae74
            comboYearThaiMed.removeAllItems();
            comboYearThaiMed.addItem("-");
            listStmpNoni = new UtilDao().getStmpDistinct("RPT_OPBKK_TMD_MOM", "STMP");

            List<String> listOpae74 = new ArrayList<String>();

            for (int i = 0; i < listStmpNoni.size(); i++) {
                listOpae74.add(listStmpNoni.get(i).getStmpYM());
            }
            Collections.sort(listOpae74);
            for (String string : listOpae74) {
                comboYearThaiMed.addItem(string);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public OppReport setInputFormReport() {
        OppReport report = new OppReport();
        report.setYearMonth(comboYearThaiMed.getSelectedItem().toString());
        report.setNo(comboNumThaiMed.getSelectedItem().toString());
        report.setPathFile(txtPathFileThaiMed.getText());
        if (radioDetailThaiMed.isSelected()) {
            report.setReportType(0);
        } else if (radioSumThaiMed.isSelected()) {
            report.setReportType(1);
        }
        if (radioSingleHospitalThaiMed.isSelected()) {
            //report.setServiceCode(txtHCodeOpae74.getText());
            report.setListServiceCode(listSelectHospital);
        }

        report.setMonth(baseFunction.subStringYearMonth(comboYearThaiMed.getSelectedItem().toString()).get("M").toString());
        report.setYear(baseFunction.subStringYearMonth(comboYearThaiMed.getSelectedItem().toString()).get("Y").toString());
        report.setTitle1(txtTitle1.getText());
        if (radioForUse_Genaral.isSelected()) {
            report.setFor_use(0);
        } else if (radioForUse_Website.isSelected()) {
            report.setFor_use(1);
        }
        if (comboLookupYear.getSelectedIndex() == 0) {
            report.setBudget_year("");
        } else {
            report.setBudget_year(String.valueOf(comboLookupYear.getSelectedItem()));
        }
        report.setStmp(report.getYearMonth() + "-" + report.getNo());
        report.setBudget_date(comboYearThaiMed.getSelectedItem().toString());
         report.setTmdServiceType(Constants.TMD_MOM);
        return report;
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnThaiMedChooseHospital;
    private javax.swing.JButton btnThaiMedGenReport;
    private javax.swing.JButton btnThaiMedGenReportAllFunction;
    private javax.swing.JButton btnThaiMedPathFile;
    private javax.swing.JButton btnThaiMedPathFileDesktop;
    private javax.swing.JComboBox comboLookupYear;
    private javax.swing.JComboBox comboNumThaiMed;
    private javax.swing.JComboBox comboYearThaiMed;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel19;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane8;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.ButtonGroup rGroupTmdForUse;
    private javax.swing.ButtonGroup rGroupTmdHospital;
    private javax.swing.ButtonGroup rGroupTmdServiceType;
    private javax.swing.ButtonGroup rGroupTmdType;
    private javax.swing.ButtonGroup rGroupTmd_special;
    private javax.swing.JRadioButton radioAllHospitalThaiMed;
    private javax.swing.JRadioButton radioDetailThaiMed;
    private javax.swing.JRadioButton radioForUse_Genaral;
    private javax.swing.JRadioButton radioForUse_Website;
    private javax.swing.JRadioButton radioSingleHospitalThaiMed;
    private javax.swing.JRadioButton radioSumThaiMed;
    private javax.swing.JPanel tabOpae74;
    public static javax.swing.JTextField txtFooter1;
    private javax.swing.JTextArea txtHnameThaiMed;
    private javax.swing.JTextField txtPathFileThaiMed;
    public static javax.swing.JTextField txtTitle1;
    public static javax.swing.JTextField txtTitle2;
    // End of variables declaration//GEN-END:variables
}
