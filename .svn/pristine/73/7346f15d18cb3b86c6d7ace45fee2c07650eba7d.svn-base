/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.claim.ui;

import com.claim.controller.LogAppController;
import com.claim.controller.Noni2015Controller;
import com.claim.dao.UtilDao;
import com.claim.object.HospitalService;
import com.claim.object.OppReport;
import com.claim.object.Stmp;
import com.claim.support.BaseFunction;
import com.claim.support.Constants;
import com.claim.support.NetUtils;
import com.claim.support.ProgrameStatus;
import com.claim.dialog.DialogWaitProcess;
import java.awt.event.ItemEvent;
import java.io.File;
import java.net.UnknownHostException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

/**
 *
 * @author Poolsawat.a
 */
public class UiReportNoni extends javax.swing.JInternalFrame {

    /**
     * Creates new form UiOpae74
     */
    public static int PROCESS = 0;
    Noni2015Controller noni2015Controller;
    List<HospitalService> listSelectHospital = null;
    List<Stmp> listStmpNoni = null;
    BaseFunction baseFunction;

    public UiReportNoni() {
        PROCESS = 0;
        initComponents();
        noni2015Controller = new Noni2015Controller();
        listSelectHospital = new ArrayList<HospitalService>();
        listStmpNoni = new ArrayList<Stmp>();
        baseFunction = new BaseFunction();

        this.loadCombo();

        PROCESS = 1;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        rGroup74Type = new javax.swing.ButtonGroup();
        rGroup74Hospital = new javax.swing.ButtonGroup();
        rGroupOpae74_special = new javax.swing.ButtonGroup();
        rGroupOpae74ForUse = new javax.swing.ButtonGroup();
        tabOpae74 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        jPanel9 = new javax.swing.JPanel();
        jLabel5 = new javax.swing.JLabel();
        comboYearNoni = new javax.swing.JComboBox();
        jLabel9 = new javax.swing.JLabel();
        comboNumNoni = new javax.swing.JComboBox();
        jPanel10 = new javax.swing.JPanel();
        radioDetailNoni = new javax.swing.JRadioButton();
        radioSumNoni = new javax.swing.JRadioButton();
        jPanel11 = new javax.swing.JPanel();
        radioAllHospitalNoni = new javax.swing.JRadioButton();
        radioSingleHospitalNoni = new javax.swing.JRadioButton();
        btnNoniChooseHospital = new javax.swing.JButton();
        jScrollPane8 = new javax.swing.JScrollPane();
        txtHnameNoni = new javax.swing.JTextArea();
        jPanel12 = new javax.swing.JPanel();
        btnNoniPathFile = new javax.swing.JButton();
        txtPathFileNoni = new javax.swing.JTextField();
        btnNoniPathFileDesktop = new javax.swing.JButton();
        jPanel19 = new javax.swing.JPanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel3 = new javax.swing.JPanel();
        txtTitle1 = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        txtTitle2 = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        txtFooter1 = new javax.swing.JTextField();
        jPanel45 = new javax.swing.JPanel();
        radio_special_noni_1 = new javax.swing.JRadioButton();
        jPanel1 = new javax.swing.JPanel();
        btn74GenReportAllFunction = new javax.swing.JButton();
        btnNoniGenReport = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        radioForUse_Genaral = new javax.swing.JRadioButton();
        radioForUse_Website = new javax.swing.JRadioButton();
        jPanel13 = new javax.swing.JPanel();
        comboLookupYear = new javax.swing.JComboBox();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("หน้าจอออกรายงาน Noni");
        setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Excel-icon.png"))); // NOI18N
        setPreferredSize(new java.awt.Dimension(1200, 560));

        tabOpae74.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel8.setPreferredSize(new java.awt.Dimension(900, 520));

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "งวดการจ่ายเงิน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        jLabel5.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        jLabel5.setText("ปีเดือน");

        comboYearNoni.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboYearNoni.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboYearNoniItemStateChanged(evt);
            }
        });

        jLabel9.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        jLabel9.setText("งวดที่");

        comboNumNoni.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboNumNoni.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboNumNoniItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboYearNoni, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(30, 30, 30)
                .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboNumNoni, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(comboYearNoni, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9)
                    .addComponent(comboNumNoni, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(18, Short.MAX_VALUE))
        );

        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "รูปแบบ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroup74Type.add(radioDetailNoni);
        radioDetailNoni.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioDetailNoni.setSelected(true);
        radioDetailNoni.setText("รายงานแบบรายละเอียด");
        radioDetailNoni.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioDetailNoniItemStateChanged(evt);
            }
        });

        rGroup74Type.add(radioSumNoni);
        radioSumNoni.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioSumNoni.setText("รายงานแบบสรุป");
        radioSumNoni.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSumNoniItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(radioDetailNoni, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(radioSumNoni, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(302, 302, 302))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioDetailNoni)
                    .addComponent(radioSumNoni)))
        );

        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "หน่วยให้บริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel11.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        rGroup74Hospital.add(radioAllHospitalNoni);
        radioAllHospitalNoni.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioAllHospitalNoni.setText("หน่วยให้บริการทั้งหมด");
        radioAllHospitalNoni.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioAllHospitalNoniItemStateChanged(evt);
            }
        });
        jPanel11.add(radioAllHospitalNoni, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 20, -1, -1));

        rGroup74Hospital.add(radioSingleHospitalNoni);
        radioSingleHospitalNoni.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioSingleHospitalNoni.setText("เลือกบางหน่วยให้บริการ");
        radioSingleHospitalNoni.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSingleHospitalNoniItemStateChanged(evt);
            }
        });
        jPanel11.add(radioSingleHospitalNoni, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 60, -1, -1));

        btnNoniChooseHospital.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnNoniChooseHospital.setText("เลือก");
        btnNoniChooseHospital.setEnabled(false);
        btnNoniChooseHospital.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNoniChooseHospitalActionPerformed(evt);
            }
        });
        jPanel11.add(btnNoniChooseHospital, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 60, -1, -1));

        jScrollPane8.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        jScrollPane8.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);

        txtHnameNoni.setColumns(20);
        txtHnameNoni.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        txtHnameNoni.setForeground(java.awt.Color.blue);
        txtHnameNoni.setLineWrap(true);
        txtHnameNoni.setRows(5);
        txtHnameNoni.setEnabled(false);
        jScrollPane8.setViewportView(txtHnameNoni);

        jPanel11.add(jScrollPane8, new org.netbeans.lib.awtextra.AbsoluteConstraints(310, 20, 540, 70));

        jPanel12.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "สถานที่เก็บไฟล์", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        btnNoniPathFile.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnNoniPathFile.setText("เลือก");
        btnNoniPathFile.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNoniPathFilejButtonFolderActionPerformed(evt);
            }
        });

        txtPathFileNoni.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        txtPathFileNoni.setEnabled(false);

        btnNoniPathFileDesktop.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnNoniPathFileDesktop.setText("desktop");
        btnNoniPathFileDesktop.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNoniPathFileDesktopjButtonFolderActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnNoniPathFileDesktop)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnNoniPathFile)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtPathFileNoni, javax.swing.GroupLayout.PREFERRED_SIZE, 686, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(102, 102, 102))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnNoniPathFile)
                    .addComponent(txtPathFileNoni, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnNoniPathFileDesktop))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel19.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ตัวอย่างแสดง หัวรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        jTabbedPane1.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N

        txtTitle1.setFont(new java.awt.Font("TH SarabunPSK", 0, 18)); // NOI18N
        txtTitle1.setText("รายละเอียดการจ่ายชดเชยค่าบริการ  กรณีกึ่งผู้ป่วยนอกกึ่งผู้ป่วยใน (NONI)  ปีงบประมาณ 2557");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle1, javax.swing.GroupLayout.DEFAULT_SIZE, 802, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle1)
                .addContainerGap())
        );

        jTabbedPane1.addTab("หัวรายงานบนสุด", jPanel3);

        txtTitle2.setFont(new java.awt.Font("TH SarabunPSK", 0, 18)); // NOI18N
        txtTitle2.setEnabled(false);

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle2, javax.swing.GroupLayout.DEFAULT_SIZE, 802, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle2)
                .addContainerGap())
        );

        jTabbedPane1.addTab("หัวรายงานรอง", jPanel4);

        txtFooter1.setEnabled(false);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter1, javax.swing.GroupLayout.DEFAULT_SIZE, 802, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter1, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("ท้ายรายงาน", jPanel5);

        javax.swing.GroupLayout jPanel19Layout = new javax.swing.GroupLayout(jPanel19);
        jPanel19.setLayout(jPanel19Layout);
        jPanel19Layout.setHorizontalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane1)
                .addContainerGap())
        );
        jPanel19Layout.setVerticalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        jPanel45.setBackground(new java.awt.Color(255, 208, 208));
        jPanel45.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "พิเศษ รายละเอียด", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        radio_special_noni_1.setBackground(new java.awt.Color(168, 226, 251));
        rGroupOpae74_special.add(radio_special_noni_1);
        radio_special_noni_1.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N
        radio_special_noni_1.setSelected(true);
        radio_special_noni_1.setText("1 ไฟล์ 1 hcode");

        javax.swing.GroupLayout jPanel45Layout = new javax.swing.GroupLayout(jPanel45);
        jPanel45.setLayout(jPanel45Layout);
        jPanel45Layout.setHorizontalGroup(
            jPanel45Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel45Layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addComponent(radio_special_noni_1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(304, 304, 304))
        );
        jPanel45Layout.setVerticalGroup(
            jPanel45Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel45Layout.createSequentialGroup()
                .addComponent(radio_special_noni_1)
                .addGap(0, 21, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, 609, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel45, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addComponent(jPanel19, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                .addGap(41, 41, Short.MAX_VALUE))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel45, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(8, 8, 8)
                .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, 102, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(37, Short.MAX_VALUE))
        );

        tabOpae74.add(jPanel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 0, 910, -1));

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "เครื่องมือการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel1.setPreferredSize(new java.awt.Dimension(215, 445));

        btn74GenReportAllFunction.setBackground(new java.awt.Color(255, 204, 0));
        btn74GenReportAllFunction.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btn74GenReportAllFunction.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btn74GenReportAllFunction.setText("<html>ออกรายงานทุกอย่าง<br />+ Website</html>");
        btn74GenReportAllFunction.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn74GenReportAllFunctionActionPerformed(evt);
            }
        });

        btnNoniGenReport.setBackground(new java.awt.Color(153, 153, 255));
        btnNoniGenReport.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btnNoniGenReport.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btnNoniGenReport.setText("ออกรายงาน");
        btnNoniGenReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNoniGenReportActionPerformed(evt);
            }
        });

        jPanel2.setBackground(new java.awt.Color(255, 255, 204));
        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ใช้เพื่อ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroupOpae74ForUse.add(radioForUse_Genaral);
        radioForUse_Genaral.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioForUse_Genaral.setSelected(true);
        radioForUse_Genaral.setText("ทั่วไป");

        rGroupOpae74ForUse.add(radioForUse_Website);
        radioForUse_Website.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioForUse_Website.setText("อัพโหลด web site");
        radioForUse_Website.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioForUse_WebsiteItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(radioForUse_Genaral)
                    .addComponent(radioForUse_Website))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(radioForUse_Genaral)
                .addGap(18, 18, 18)
                .addComponent(radioForUse_Website)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel13.setBackground(new java.awt.Color(255, 255, 204));
        jPanel13.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ข้อมูลปีการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        comboLookupYear.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboLookupYear.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "รวมทุกปีงบ", "2015", "2014", "2013", "2012", "2011", "2010" }));

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(24, Short.MAX_VALUE))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(29, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(btn74GenReportAllFunction, javax.swing.GroupLayout.DEFAULT_SIZE, 155, Short.MAX_VALUE)
                            .addComponent(btnNoniGenReport, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(0, 43, Short.MAX_VALUE))
                    .addComponent(jPanel13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 40, Short.MAX_VALUE)
                .addComponent(btnNoniGenReport, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(38, 38, 38)
                .addComponent(btn74GenReportAllFunction, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        tabOpae74.add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(930, 0, 230, 470));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(tabOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 1064, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(tabOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 511, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void comboYearNoniItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboYearNoniItemStateChanged
        comboNumNoni.removeAllItems();
        comboNumNoni.addItem("-");
        for (Stmp stmp : listStmpNoni) {
            if (comboYearNoni.getSelectedItem().equals(stmp.getStmpYM())
                    && comboNumNoni.getSelectedItem() != stmp.getStmpN()) {
                comboNumNoni.addItem(stmp.getStmpN());
            }
        }
    }//GEN-LAST:event_comboYearNoniItemStateChanged

    private void comboNumNoniItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboNumNoniItemStateChanged

        if (PROCESS == 1 && comboNumNoni.getSelectedItem() != null) {
            /*String yearmonth = comboYearNoni.getSelectedItem().toString();
             String no = comboNumNoni.getSelectedItem().toString();
             String stmp = yearmonth + "-" + no;
             if (stmp.length() == 8) {
             txtTitle2.setText(new DateUtil().convertStmpToString(yearmonth + "-" + no));
             }*/
            //txtTitle2.setText(noni2015Controller.getNoniStmpGroupBy(comboYearNoni.getSelectedItem(), comboNumNoni.getSelectedItem()));
        }
    }//GEN-LAST:event_comboNumNoniItemStateChanged

    private void radioDetailNoniItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioDetailNoniItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            txtTitle1.setText(Noni2015Controller.HEADER_DETAIL);
            btnNoniChooseHospital.setEnabled(false);
        } else {
            txtTitle1.setText(Noni2015Controller.HEADER_SUM);
        }
    }//GEN-LAST:event_radioDetailNoniItemStateChanged

    private void radioSumNoniItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSumNoniItemStateChanged
        if (radioSumNoni.isSelected()) {
            radioAllHospitalNoni.setSelected(true);
            radioSingleHospitalNoni.setEnabled(false);
            btnNoniChooseHospital.setEnabled(false);
        } else {
            radioSingleHospitalNoni.setEnabled(true);
            //btn74ChooseHospital.setEnabled(true);
        }
    }//GEN-LAST:event_radioSumNoniItemStateChanged

    private void radioAllHospitalNoniItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioAllHospitalNoniItemStateChanged
        if (radioAllHospitalNoni.isSelected()) {
            btnNoniChooseHospital.setEnabled(false);
            //txtHCodeOpae74.setText("");
            txtHnameNoni.setText("");
        } else {
            radioAllHospitalNoni.setEnabled(true);
        }
    }//GEN-LAST:event_radioAllHospitalNoniItemStateChanged

    private void radioSingleHospitalNoniItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSingleHospitalNoniItemStateChanged
        if (radioSingleHospitalNoni.isSelected()) {
            btnNoniChooseHospital.setEnabled(true);
        } else {
            radioSingleHospitalNoni.setEnabled(true);
        }
    }//GEN-LAST:event_radioSingleHospitalNoniItemStateChanged

    private void btnNoniChooseHospitalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNoniChooseHospitalActionPerformed
        txtHnameNoni.setText("");
        if (listSelectHospital.size() > 0) {
            listSelectHospital.removeAll(listSelectHospital);
            System.out.println("Clear listSelectHospital success");
        }
        HashMap mapParam = new HashMap();
        mapParam.put("type", "opae74");
        //mapParam.put("code", txtHCodeOpae74);
        mapParam.put("name", txtHnameNoni);
        mapParam.put("listHospital", listSelectHospital);
        DialogService dialog = new DialogService();
        dialog.DialogServiceJInternalFrame(this, true, mapParam);
        dialog.setVisible(true);
    }//GEN-LAST:event_btnNoniChooseHospitalActionPerformed

    private void btnNoniPathFilejButtonFolderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNoniPathFilejButtonFolderActionPerformed
        try {
            JFileChooser fc = new JFileChooser();
            fc.setDialogTitle("Open Folder");
            fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            fc.setCurrentDirectory(new File(""));
            int result = fc.showOpenDialog(this);
            if (result == JFileChooser.APPROVE_OPTION) {
                File a = fc.getSelectedFile();
                // Path File method in this class
                String temp = a.getPath();
                txtPathFileNoni.setText(".");

                if (temp != null) {
                    txtPathFileNoni.setText(temp);
                    //txtPathFileOpae74.setEnabled(true);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnNoniPathFilejButtonFolderActionPerformed

    private void btnNoniPathFileDesktopjButtonFolderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNoniPathFileDesktopjButtonFolderActionPerformed
        try {
            String desktopPath = System.getProperty("user.home") + "\\" + "Desktop";
            System.out.println("pathDesktop==>>" + desktopPath);
            txtPathFileNoni.setText(desktopPath);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnNoniPathFileDesktopjButtonFolderActionPerformed

    private void btnNoniGenReportActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNoniGenReportActionPerformed
        final DialogWaitProcess wait = new DialogWaitProcess();

        try {
            if (comboYearNoni.getSelectedIndex() != 0) {
                if (comboNumNoni.getSelectedIndex() != 0) {
                    if (radioDetailNoni.isSelected() || radioSumNoni.isSelected()) {
                        if (radioAllHospitalNoni.isSelected()
                                || radioSingleHospitalNoni.isSelected() && listSelectHospital.size() > 0) {
                            if (!txtPathFileNoni.getText().isEmpty()) {
                                int selectOption = JOptionPane.showConfirmDialog(null,
                                        Constants.MSG_REPORT_CONFIRM,
                                        Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                if (selectOption == JOptionPane.YES_OPTION) {
                                    wait.setVisible(true);

                                    Thread thread = new Thread(new Runnable() {
                                        @Override
                                        public void run() {
                                            ProgrameStatus programeStatus = new ProgrameStatus();
                                            try {
                                                wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                if (radioDetailNoni.isSelected()) { // รายละเอียด
                                                    programeStatus = new Noni2015Controller().noniDetail_byHcode(setInputFormReport());
                                                    //action controller 
                                                    if (programeStatus.getProcessStatus()) {
                                                        JOptionPane.showMessageDialog(UiReportNoni.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.INFORMATION_MESSAGE);
                                                        baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                    } else {
                                                        JOptionPane.showMessageDialog(UiReportNoni.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.ERROR_MESSAGE);
                                                    }
                                                } else { // สรุป

                                                    programeStatus = new Noni2015Controller().noniSum(setInputFormReport());

                                                    if (programeStatus.getProcessStatus()) {
                                                        JOptionPane.showMessageDialog(UiReportNoni.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.INFORMATION_MESSAGE);
                                                        baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                    } else {
                                                        JOptionPane.showMessageDialog(UiReportNoni.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.ERROR_MESSAGE);
                                                    }
                                                }
                                                wait.setVisible(false);
                                            } catch (Exception e) {
                                                e.printStackTrace();
                                            }
                                             /*
                                            * 17-08-2015
                                            */
                                            /*try {
                                                new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน noni แบบ บางฟังก์ชั่น การทำงาน ", NetUtils.getIpAddress(), 1);
                                            } catch (UnknownHostException ex) {
                                                Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                            }*/
                                        }
                                    });
                                    thread.start();
                                }

                            } else {
                                JOptionPane.showMessageDialog(this,
                                        Constants.MSG_FILE_LOCATION_PLEASE,
                                        Constants.MSG_FILE_LOCATION,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                Constants.MSG_REPOTR_FORMAT,
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_DATA,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_DATE_PLEASE,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnNoniGenReportActionPerformed

    private void btn74GenReportAllFunctionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn74GenReportAllFunctionActionPerformed

        try {
            final DialogWaitProcess wait = new DialogWaitProcess();
            if (comboYearNoni.getSelectedIndex() != 0) {
                if (comboNumNoni.getSelectedIndex() != 0) {
                    if (radioAllHospitalNoni.isSelected() || radioSingleHospitalNoni.isSelected()) {
                        if (radioAllHospitalNoni.isSelected() || radioSingleHospitalNoni.isSelected() && listSelectHospital.size() > 0) {
                            if (!txtPathFileNoni.getText().isEmpty()) {
                                int selectOption = JOptionPane.showConfirmDialog(null,
                                        Constants.MSG_REPORT_CONFIRM,
                                        Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                if (selectOption == JOptionPane.YES_OPTION) {
                                    wait.setVisible(true);

                                    Thread thread = new Thread(new Runnable() {
                                        @Override
                                        public void run() {
                                            ProgrameStatus programeStatus = new ProgrameStatus();
                                            try {
                                                OppReport report = setInputFormReport();
                                                wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                programeStatus = noni2015Controller.noni_genReportAllFunction(report);
                                                if (programeStatus.getProcessStatus()) {
                                                    JOptionPane.showMessageDialog(UiReportNoni.this,
                                                            Constants.MSG_REPORT_SUCCESS,
                                                            Constants.MSG_REPORT_COMPLETE, JOptionPane.INFORMATION_MESSAGE);
                                                    baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());

                                                } else {
                                                    JOptionPane.showMessageDialog(UiReportNoni.this,
                                                            Constants.MSG_CAN_NOT_REPORT_ERROR,
                                                            Constants.MSG_PROCESS_FAILS,
                                                            JOptionPane.ERROR_MESSAGE);
                                                }
                                                wait.setVisible(false);
                                            } catch (Exception e) {
                                                e.printStackTrace();
                                            }
                                             /*
                                            * 17-08-2015
                                            */
                                            /*try {
                                                new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน noni แบบ ฟังก์ชั้นการทำงานทั้งหมด ", NetUtils.getIpAddress(), 1);
                                            } catch (UnknownHostException ex) {
                                                Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                            }*/
                                        }
                                    });
                                    thread.start();

                                }
                            } else {
                                JOptionPane.showMessageDialog(this,
                                        Constants.MSG_FILE_LOCATION_PLEASE,
                                        Constants.MSG_FILE_LOCATION,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                Constants.MSG_HOSPITAL_ATTRIBUTE,
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_DATA,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_NO,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btn74GenReportAllFunctionActionPerformed

    private void radioForUse_WebsiteItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioForUse_WebsiteItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            comboLookupYear.setEnabled(false);
        } else {
            comboLookupYear.setEnabled(true);
        }
    }//GEN-LAST:event_radioForUse_WebsiteItemStateChanged
    public void loadCombo() {
        try {
            //Tab Opae74
            //get Stmp From Table Rpt_Opbkk_opae74
            comboYearNoni.removeAllItems();
            comboYearNoni.addItem("-");
            listStmpNoni = new UtilDao().getStmpDistinct("rpt_opbkk_noni", "stmp");

            List<String> listOpae74 = new ArrayList<String>();

            for (int i = 0; i < listStmpNoni.size(); i++) {
                listOpae74.add(listStmpNoni.get(i).getStmpYM());
            }
            Collections.sort(listOpae74);
            for (String string : listOpae74) {
                comboYearNoni.addItem(string);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public OppReport setInputFormReport() {
        OppReport report = new OppReport();
        report.setYearMonth(comboYearNoni.getSelectedItem().toString());
        report.setNo(comboNumNoni.getSelectedItem().toString());
        report.setPathFile(txtPathFileNoni.getText());
        if (radioDetailNoni.isSelected()) {
            report.setReportType(0);
        } else if (radioSumNoni.isSelected()) {
            report.setReportType(1);
        }
        if (radioSingleHospitalNoni.isSelected()) {
            //report.setServiceCode(txtHCodeOpae74.getText());
            report.setListServiceCode(listSelectHospital);
        }

        report.setMonth(baseFunction.subStringYearMonth(comboYearNoni.getSelectedItem().toString()).get("M").toString());
        report.setYear(baseFunction.subStringYearMonth(comboYearNoni.getSelectedItem().toString()).get("Y").toString());
        report.setTitle1(txtTitle1.getText());
        if (radioForUse_Genaral.isSelected()) {
            report.setFor_use(0);
        } else if (radioForUse_Website.isSelected()) {
            report.setFor_use(1);
        }
        if (comboLookupYear.getSelectedIndex() == 0) {
            report.setBudget_year("");
        } else {
            report.setBudget_year(String.valueOf(comboLookupYear.getSelectedItem()));
        }
        report.setStmp(report.getYearMonth() + "-" + report.getNo());
        report.setBudget_date(comboYearNoni.getSelectedItem().toString());
        return report;
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btn74GenReportAllFunction;
    private javax.swing.JButton btnNoniChooseHospital;
    private javax.swing.JButton btnNoniGenReport;
    private javax.swing.JButton btnNoniPathFile;
    private javax.swing.JButton btnNoniPathFileDesktop;
    private javax.swing.JComboBox comboLookupYear;
    private javax.swing.JComboBox comboNumNoni;
    private javax.swing.JComboBox comboYearNoni;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel19;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel45;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane8;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.ButtonGroup rGroup74Hospital;
    private javax.swing.ButtonGroup rGroup74Type;
    private javax.swing.ButtonGroup rGroupOpae74ForUse;
    private javax.swing.ButtonGroup rGroupOpae74_special;
    private javax.swing.JRadioButton radioAllHospitalNoni;
    private javax.swing.JRadioButton radioDetailNoni;
    private javax.swing.JRadioButton radioForUse_Genaral;
    private javax.swing.JRadioButton radioForUse_Website;
    private javax.swing.JRadioButton radioSingleHospitalNoni;
    private javax.swing.JRadioButton radioSumNoni;
    private javax.swing.JRadioButton radio_special_noni_1;
    private javax.swing.JPanel tabOpae74;
    public static javax.swing.JTextField txtFooter1;
    private javax.swing.JTextArea txtHnameNoni;
    private javax.swing.JTextField txtPathFileNoni;
    public static javax.swing.JTextField txtTitle1;
    public static javax.swing.JTextField txtTitle2;
    // End of variables declaration//GEN-END:variables
}
