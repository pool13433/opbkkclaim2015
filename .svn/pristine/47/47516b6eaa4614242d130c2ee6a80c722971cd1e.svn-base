/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.claim.ui;

import com.claim.controller.LogAppController;
import com.claim.controller.Opae74Controller;
import com.claim.dao.UtilDao;
import com.claim.object.HospitalService;
import com.claim.object.OppReport;
import com.claim.object.Stmp;
import com.claim.support.BaseFunction;
import com.claim.support.Constants;
import com.claim.support.NetUtils;
import com.claim.support.ProgrameStatus;
import com.claim.dialog.DialogWaitProcess;
import java.awt.event.ItemEvent;
import java.io.File;
import java.net.UnknownHostException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

/**
 *
 * @author Poolsawat.a
 */
public class UiReportOpae74 extends javax.swing.JInternalFrame {

    /**
     * Creates new form UiOpae74
     */
    public static int PROCESS = 0;
    Opae74Controller opae74Controller;
    List<HospitalService> listSelectHospital = null;
    List<Stmp> listStmpOpae74 = null;
    BaseFunction baseFunction;
    
    public UiReportOpae74() {
        initComponents();
        opae74Controller = new Opae74Controller();
        listSelectHospital = new ArrayList<HospitalService>();
        listStmpOpae74 = new ArrayList<Stmp>();
        baseFunction = new BaseFunction();
        
        this.loadCombo();
        
        PROCESS = 1;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        rGroup74Type = new javax.swing.ButtonGroup();
        rGroup74Hospital = new javax.swing.ButtonGroup();
        rGroupOpae74_special = new javax.swing.ButtonGroup();
        rGroupOpae74ForUse = new javax.swing.ButtonGroup();
        tabOpae74 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        jPanel9 = new javax.swing.JPanel();
        jLabel5 = new javax.swing.JLabel();
        comboYearOpae74 = new javax.swing.JComboBox();
        jLabel9 = new javax.swing.JLabel();
        comboNumOpae74 = new javax.swing.JComboBox();
        jPanel10 = new javax.swing.JPanel();
        radioDetailOpae74 = new javax.swing.JRadioButton();
        radioSumOpae74 = new javax.swing.JRadioButton();
        radioItemDetail = new javax.swing.JRadioButton();
        radioCar = new javax.swing.JRadioButton();
        jPanel11 = new javax.swing.JPanel();
        radioAllHospitalOpae74 = new javax.swing.JRadioButton();
        radioSingleHospitalOpae74 = new javax.swing.JRadioButton();
        btn74ChooseHospital = new javax.swing.JButton();
        jScrollPane8 = new javax.swing.JScrollPane();
        txtHnameOpae74 = new javax.swing.JTextArea();
        jPanel12 = new javax.swing.JPanel();
        btn74PathFile = new javax.swing.JButton();
        txtPathFileOpae74 = new javax.swing.JTextField();
        btn74PathFileDesktop = new javax.swing.JButton();
        jPanel19 = new javax.swing.JPanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel3 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        txtTitle1 = new javax.swing.JTextArea();
        jPanel4 = new javax.swing.JPanel();
        txtTitle2 = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        txtFooter1 = new javax.swing.JTextField();
        jPanel25 = new javax.swing.JPanel();
        checkOpae74_rehap = new javax.swing.JCheckBox();
        jPanel45 = new javax.swing.JPanel();
        radio_special_opae74_1 = new javax.swing.JRadioButton();
        radio_special_opae74_2 = new javax.swing.JRadioButton();
        radio_special_opae74_all = new javax.swing.JRadioButton();
        jPanel1 = new javax.swing.JPanel();
        btn74GenReportAllFunction = new javax.swing.JButton();
        btn74GenReport = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        radioForUse_Genaral = new javax.swing.JRadioButton();
        radioForUse_Website = new javax.swing.JRadioButton();
        jPanel13 = new javax.swing.JPanel();
        comboLookupYear = new javax.swing.JComboBox();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("หน้าจอออกรายงาน Opae74");
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Excel-icon.png"))); // NOI18N
        setPreferredSize(new java.awt.Dimension(1200, 560));

        tabOpae74.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel8.setPreferredSize(new java.awt.Dimension(900, 520));

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "งวดการจ่ายเงิน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        jLabel5.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        jLabel5.setText("ปีเดือน");

        comboYearOpae74.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboYearOpae74.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboYearOpae74ItemStateChanged(evt);
            }
        });

        jLabel9.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        jLabel9.setText("งวดที่");

        comboNumOpae74.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboNumOpae74.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboNumOpae74ItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboYearOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(30, 30, 30)
                .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboNumOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(comboYearOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9)
                    .addComponent(comboNumOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "รูปแบบ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroup74Type.add(radioDetailOpae74);
        radioDetailOpae74.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioDetailOpae74.setSelected(true);
        radioDetailOpae74.setText("รายงานแบบรายละเอียด");
        radioDetailOpae74.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioDetailOpae74ItemStateChanged(evt);
            }
        });

        rGroup74Type.add(radioSumOpae74);
        radioSumOpae74.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioSumOpae74.setText("รายงานแบบสรุป");
        radioSumOpae74.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSumOpae74ItemStateChanged(evt);
            }
        });

        rGroup74Type.add(radioItemDetail);
        radioItemDetail.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioItemDetail.setText("ItemDetail");
        radioItemDetail.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioItemDetailItemStateChanged(evt);
            }
        });

        rGroup74Type.add(radioCar);
        radioCar.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioCar.setText("รายละเอียดค่าพาหนะ");
        radioCar.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioCarItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(radioDetailOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(radioSumOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(radioItemDetail)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(radioCar)
                .addGap(66, 66, 66))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioDetailOpae74)
                    .addComponent(radioSumOpae74)
                    .addComponent(radioItemDetail)
                    .addComponent(radioCar)))
        );

        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "หน่วยให้บริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel11.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        rGroup74Hospital.add(radioAllHospitalOpae74);
        radioAllHospitalOpae74.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioAllHospitalOpae74.setSelected(true);
        radioAllHospitalOpae74.setText("หน่วยให้บริการทั้งหมด");
        radioAllHospitalOpae74.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioAllHospitalOpae74ItemStateChanged(evt);
            }
        });
        jPanel11.add(radioAllHospitalOpae74, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 20, -1, -1));

        rGroup74Hospital.add(radioSingleHospitalOpae74);
        radioSingleHospitalOpae74.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioSingleHospitalOpae74.setText("เลือกบางหน่วยให้บริการ");
        radioSingleHospitalOpae74.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSingleHospitalOpae74ItemStateChanged(evt);
            }
        });
        jPanel11.add(radioSingleHospitalOpae74, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 60, -1, -1));

        btn74ChooseHospital.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btn74ChooseHospital.setText("เลือก");
        btn74ChooseHospital.setEnabled(false);
        btn74ChooseHospital.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn74ChooseHospitalActionPerformed(evt);
            }
        });
        jPanel11.add(btn74ChooseHospital, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 60, -1, -1));

        jScrollPane8.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        jScrollPane8.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);

        txtHnameOpae74.setColumns(20);
        txtHnameOpae74.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        txtHnameOpae74.setForeground(java.awt.Color.blue);
        txtHnameOpae74.setLineWrap(true);
        txtHnameOpae74.setRows(5);
        txtHnameOpae74.setEnabled(false);
        jScrollPane8.setViewportView(txtHnameOpae74);

        jPanel11.add(jScrollPane8, new org.netbeans.lib.awtextra.AbsoluteConstraints(310, 20, 540, 70));

        jPanel12.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "สถานที่เก็บไฟล์", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        btn74PathFile.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btn74PathFile.setText("เลือก");
        btn74PathFile.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn74PathFilejButtonFolderActionPerformed(evt);
            }
        });

        txtPathFileOpae74.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        txtPathFileOpae74.setEnabled(false);

        btn74PathFileDesktop.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btn74PathFileDesktop.setText("desktop");
        btn74PathFileDesktop.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn74PathFileDesktopjButtonFolderActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btn74PathFileDesktop)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn74PathFile)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtPathFileOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 686, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(102, 102, 102))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btn74PathFile)
                    .addComponent(txtPathFileOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn74PathFileDesktop))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel19.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ตัวอย่างแสดง หัวรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        jTabbedPane1.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N

        txtTitle1.setColumns(20);
        txtTitle1.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        txtTitle1.setRows(5);
        txtTitle1.setText("รายละเอียดการจ่ายชดเชยค่าบริการ  กรณีอุบัติเหตุ/ฉุกเฉินต่างบัญชีเครือข่าย(OPAE)  กรณีผู้พิการ(Opพิการ)  กรณีฟื้นฟูสมรรถภาพ และอุปกรณ์เครื่องช่วยคนพิการ ปีงบประมาณ");
        jScrollPane1.setViewportView(txtTitle1);

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 819, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 7, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("หัวรายงานบนสุด", jPanel3);

        txtTitle2.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        txtTitle2.setCursor(new java.awt.Cursor(java.awt.Cursor.TEXT_CURSOR));

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle2, javax.swing.GroupLayout.DEFAULT_SIZE, 819, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(26, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("หัวรายงานรอง", jPanel4);

        txtFooter1.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter1, javax.swing.GroupLayout.DEFAULT_SIZE, 819, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(30, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("ท้ายรายงาน", jPanel5);

        javax.swing.GroupLayout jPanel19Layout = new javax.swing.GroupLayout(jPanel19);
        jPanel19.setLayout(jPanel19Layout);
        jPanel19Layout.setHorizontalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane1)
                .addContainerGap())
        );
        jPanel19Layout.setVerticalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 106, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        jPanel25.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "สรุป rehap (เครื่องช่วยฟัง คนพิการ)", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        checkOpae74_rehap.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        checkOpae74_rehap.setText("แยกออกเฉพาะ  rehap ");
        checkOpae74_rehap.setEnabled(false);

        javax.swing.GroupLayout jPanel25Layout = new javax.swing.GroupLayout(jPanel25);
        jPanel25.setLayout(jPanel25Layout);
        jPanel25Layout.setHorizontalGroup(
            jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addComponent(checkOpae74_rehap)
                .addContainerGap(64, Short.MAX_VALUE))
        );
        jPanel25Layout.setVerticalGroup(
            jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addComponent(checkOpae74_rehap)
                .addGap(0, 9, Short.MAX_VALUE))
        );

        jPanel45.setBackground(new java.awt.Color(255, 208, 208));
        jPanel45.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "พิเศษ รายละเอียด", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        radio_special_opae74_1.setBackground(java.awt.Color.yellow);
        rGroupOpae74_special.add(radio_special_opae74_1);
        radio_special_opae74_1.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N
        radio_special_opae74_1.setText("1 ไฟล์ 1 hcode แยกเดือน");

        radio_special_opae74_2.setBackground(new java.awt.Color(168, 226, 251));
        rGroupOpae74_special.add(radio_special_opae74_2);
        radio_special_opae74_2.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N
        radio_special_opae74_2.setText("1 ไฟล์ 1 hcode");

        radio_special_opae74_all.setBackground(new java.awt.Color(172, 255, 113));
        rGroupOpae74_special.add(radio_special_opae74_all);
        radio_special_opae74_all.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N
        radio_special_opae74_all.setText("1 ไฟล์ ทุก hcode");

        javax.swing.GroupLayout jPanel45Layout = new javax.swing.GroupLayout(jPanel45);
        jPanel45.setLayout(jPanel45Layout);
        jPanel45Layout.setHorizontalGroup(
            jPanel45Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel45Layout.createSequentialGroup()
                .addGap(17, 17, 17)
                .addComponent(radio_special_opae74_1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(radio_special_opae74_2, javax.swing.GroupLayout.DEFAULT_SIZE, 110, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(radio_special_opae74_all, javax.swing.GroupLayout.PREFERRED_SIZE, 122, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(16, 16, 16))
        );
        jPanel45Layout.setVerticalGroup(
            jPanel45Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel45Layout.createSequentialGroup()
                .addGroup(jPanel45Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radio_special_opae74_1)
                    .addComponent(radio_special_opae74_2)
                    .addComponent(radio_special_opae74_all))
                .addGap(0, 21, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel45, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, 609, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel25, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel19, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(24, Short.MAX_VALUE))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel45, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, 76, Short.MAX_VALUE))
                .addGap(3, 3, 3)
                .addComponent(jPanel19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel25, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, 102, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        tabOpae74.add(jPanel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 0, 910, -1));

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "เครื่องมือการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel1.setPreferredSize(new java.awt.Dimension(215, 445));

        btn74GenReportAllFunction.setBackground(new java.awt.Color(255, 204, 0));
        btn74GenReportAllFunction.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btn74GenReportAllFunction.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btn74GenReportAllFunction.setText("<html>ออกรายงานทุกอย่าง<br />+ Website</html>");
        btn74GenReportAllFunction.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn74GenReportAllFunctionActionPerformed(evt);
            }
        });

        btn74GenReport.setBackground(new java.awt.Color(153, 153, 255));
        btn74GenReport.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        btn74GenReport.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btn74GenReport.setText("ออกรายงาน");
        btn74GenReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn74GenReportActionPerformed(evt);
            }
        });

        jPanel2.setBackground(new java.awt.Color(255, 255, 204));
        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ใช้เพื่อ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroupOpae74ForUse.add(radioForUse_Genaral);
        radioForUse_Genaral.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioForUse_Genaral.setSelected(true);
        radioForUse_Genaral.setText("ทั่วไป");

        rGroupOpae74ForUse.add(radioForUse_Website);
        radioForUse_Website.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        radioForUse_Website.setText("อัพโหลด web site");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(radioForUse_Genaral)
                    .addComponent(radioForUse_Website))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(radioForUse_Genaral)
                .addGap(18, 18, 18)
                .addComponent(radioForUse_Website)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel13.setBackground(new java.awt.Color(255, 255, 204));
        jPanel13.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ข้อมูลปีการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        comboLookupYear.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboLookupYear.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "รวมทุกปีงบ", "2015", "2014", "2013", "2012", "2011", "2010" }));

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(24, Short.MAX_VALUE))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(29, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(btn74GenReportAllFunction, javax.swing.GroupLayout.DEFAULT_SIZE, 155, Short.MAX_VALUE)
                            .addComponent(btn74GenReport, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(0, 43, Short.MAX_VALUE))
                    .addComponent(jPanel13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 40, Short.MAX_VALUE)
                .addComponent(btn74GenReport, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(38, 38, 38)
                .addComponent(btn74GenReportAllFunction, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        tabOpae74.add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(930, 0, 230, 470));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(tabOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 1064, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(tabOpae74, javax.swing.GroupLayout.PREFERRED_SIZE, 511, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void comboYearOpae74ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboYearOpae74ItemStateChanged
        comboNumOpae74.removeAllItems();
        comboNumOpae74.addItem("-");
        for (Stmp stmp : listStmpOpae74) {
            if (comboYearOpae74.getSelectedItem().equals(stmp.getStmpYM())
                    && comboNumOpae74.getSelectedItem() != stmp.getStmpN()) {
                comboNumOpae74.addItem(stmp.getStmpN());
            }
        }
    }//GEN-LAST:event_comboYearOpae74ItemStateChanged

    private void comboNumOpae74ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboNumOpae74ItemStateChanged
        txtTitle2.setText(opae74Controller.getOpae74StmpGroupBy(comboYearOpae74.getSelectedItem(), comboNumOpae74.getSelectedItem()));
    }//GEN-LAST:event_comboNumOpae74ItemStateChanged

    private void radioDetailOpae74ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioDetailOpae74ItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            btn74ChooseHospital.setEnabled(false);
            checkOpae74_rehap.setEnabled(false);
        } else {
            //btn74ChooseHospital.setEnabled(true);
            checkOpae74_rehap.setEnabled(true);
        }
    }//GEN-LAST:event_radioDetailOpae74ItemStateChanged

    private void radioSumOpae74ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSumOpae74ItemStateChanged
        if (radioSumOpae74.isSelected()) {
            radioAllHospitalOpae74.setSelected(true);
            radioSingleHospitalOpae74.setEnabled(false);
            btn74ChooseHospital.setEnabled(false);
            checkOpae74_rehap.setEnabled(true);
        } else {
            radioSingleHospitalOpae74.setEnabled(true);
            //btn74ChooseHospital.setEnabled(true);
            checkOpae74_rehap.setEnabled(false);
        }
    }//GEN-LAST:event_radioSumOpae74ItemStateChanged

    private void radioItemDetailItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioItemDetailItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            txtTitle1.setEnabled(false);
            radioAllHospitalOpae74.setEnabled(false);
            radioSingleHospitalOpae74.setEnabled(false);
        } else {
            txtTitle1.setEnabled(true);
            radioAllHospitalOpae74.setEnabled(true);
            radioSingleHospitalOpae74.setEnabled(true);
        }
    }//GEN-LAST:event_radioItemDetailItemStateChanged

    private void radioCarItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioCarItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            txtTitle1.setEnabled(false);
            radioAllHospitalOpae74.setEnabled(false);
            radioSingleHospitalOpae74.setEnabled(false);
        } else {
            txtTitle1.setEnabled(true);
            radioAllHospitalOpae74.setEnabled(true);
            radioSingleHospitalOpae74.setEnabled(true);
        }
    }//GEN-LAST:event_radioCarItemStateChanged

    private void radioAllHospitalOpae74ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioAllHospitalOpae74ItemStateChanged
        if (radioAllHospitalOpae74.isSelected()) {
            btn74ChooseHospital.setEnabled(false);
            //txtHCodeOpae74.setText("");
            txtHnameOpae74.setText("");
        } else {
            radioAllHospitalOpae74.setEnabled(true);
        }
    }//GEN-LAST:event_radioAllHospitalOpae74ItemStateChanged

    private void radioSingleHospitalOpae74ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSingleHospitalOpae74ItemStateChanged
        if (radioSingleHospitalOpae74.isSelected()) {
            btn74ChooseHospital.setEnabled(true);
        } else {
            radioSingleHospitalOpae74.setEnabled(true);
        }
    }//GEN-LAST:event_radioSingleHospitalOpae74ItemStateChanged

    private void btn74ChooseHospitalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn74ChooseHospitalActionPerformed
        txtHnameOpae74.setText("");
        if (listSelectHospital.size() > 0) {
            listSelectHospital.removeAll(listSelectHospital);
            System.out.println("Clear listSelectHospital success");
        }
        HashMap mapParam = new HashMap();
        mapParam.put("type", "opae74");
        //mapParam.put("code", txtHCodeOpae74);
        mapParam.put("name", txtHnameOpae74);
        mapParam.put("listHospital", listSelectHospital);
        DialogService dialog = new DialogService();
        dialog.DialogServiceJInternalFrame(this, true, mapParam);
        dialog.setVisible(true);
    }//GEN-LAST:event_btn74ChooseHospitalActionPerformed

    private void btn74PathFilejButtonFolderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn74PathFilejButtonFolderActionPerformed
        try {
            JFileChooser fc = new JFileChooser();
            fc.setDialogTitle("Open Folder");
            fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            fc.setCurrentDirectory(new File(""));
            int result = fc.showOpenDialog(this);
            if (result == JFileChooser.APPROVE_OPTION) {
                File a = fc.getSelectedFile();
                // Path File method in this class
                String temp = a.getPath();
                txtPathFileOpae74.setText(".");
                
                if (temp != null) {
                    txtPathFileOpae74.setText(temp);
                    //txtPathFileOpae74.setEnabled(true);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btn74PathFilejButtonFolderActionPerformed

    private void btn74PathFileDesktopjButtonFolderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn74PathFileDesktopjButtonFolderActionPerformed
        try {
            String desktopPath = System.getProperty("user.home") + "\\" + "Desktop";
            System.out.println("pathDesktop==>>" + desktopPath);
            txtPathFileOpae74.setText(desktopPath);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btn74PathFileDesktopjButtonFolderActionPerformed

    private void btn74GenReportActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn74GenReportActionPerformed
        final DialogWaitProcess wait = new DialogWaitProcess();
        
        try {
            if (comboYearOpae74.getSelectedIndex() != 0) {
                if (comboNumOpae74.getSelectedIndex() != 0) {
                    if (radio_special_opae74_1.isSelected() || radio_special_opae74_2.isSelected() || radio_special_opae74_all.isSelected()) {
                        if (radioAllHospitalOpae74.isSelected() || radioSingleHospitalOpae74.isSelected() || radioItemDetail.isSelected() || radioCar.isSelected()) {
                            if (radioAllHospitalOpae74.isSelected()
                                    || radioSingleHospitalOpae74.isSelected() && listSelectHospital.size() > 0
                                    || radioItemDetail.isSelected() || radioCar.isSelected()) {
                                if (!txtPathFileOpae74.getText().isEmpty()) {
                                    int selectOption = JOptionPane.showConfirmDialog(null,
                                            Constants.MSG_REPORT_CONFIRM,
                                            Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                    if (selectOption == JOptionPane.YES_OPTION) {
                                        wait.setVisible(true);
                                        
                                        Thread thread = new Thread(new Runnable() {
                                            @Override
                                            public void run() {
                                                ProgrameStatus programeStatus = new ProgrameStatus();
                                                try {
                                                    wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                    if (radioDetailOpae74.isSelected()) { // รายละเอียด

                                                        if (radio_special_opae74_1.isSelected()) {
                                                            programeStatus = opae74Controller.opae74_detail_byDateopd(setInputFormReport());
                                                        } else if (radio_special_opae74_2.isSelected()) {
                                                            programeStatus = opae74Controller.opae74_detail(setInputFormReport());
                                                        } else if (radio_special_opae74_all.isSelected()) {
                                                            programeStatus = opae74Controller.opae74_detail_all_hcode_spliteFile_65500(setInputFormReport());
                                                        } else {
                                                            System.out.println(" No Select");
                                                            programeStatus.setProcessStatus(false);
                                                            programeStatus.setMessage("ระบบผิดพลาด");
                                                            programeStatus.setTitle("ระบบผิดพลาด");
                                                        }
                                                        
                                                        if (programeStatus.getProcessStatus()) {
                                                            JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.INFORMATION_MESSAGE);
                                                            baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                        } else {
                                                            JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.ERROR_MESSAGE);
                                                        }
                                                    } else if (radioItemDetail.isSelected()) {  // item detail
                                                        programeStatus = opae74Controller.opae74_itemDetail(setInputFormReport());
                                                        if (programeStatus.getProcessStatus()) {
                                                            JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.INFORMATION_MESSAGE);
                                                            baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                        } else {
                                                            JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.ERROR_MESSAGE);
                                                        }
                                                    } else if (radioCar.isSelected()) {     // car detail
                                                        programeStatus = opae74Controller.opae74_carDetail(setInputFormReport());
                                                        if (programeStatus.getProcessStatus()) {
                                                            JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.INFORMATION_MESSAGE);
                                                            baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                        } else {
                                                            JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.ERROR_MESSAGE);
                                                        }
                                                    } else { // สรุป
                                                        if (radio_special_opae74_2.isSelected()) {
                                                            if (checkOpae74_rehap.isSelected()) {
                                                                programeStatus = opae74Controller.opae74_sumRehap_byDateopd(setInputFormReport());
                                                            } else {
                                                                programeStatus = opae74Controller.opae74_sum_ByDateopd(setInputFormReport());
                                                            }
                                                        } else {
                                                            if (checkOpae74_rehap.isSelected()) {
                                                                programeStatus = opae74Controller.opae74_sumRehap_byDateopd(setInputFormReport());
                                                            } else {
                                                                programeStatus = opae74Controller.opae74_sum(setInputFormReport());
                                                            }
                                                        }
                                                        
                                                        if (programeStatus.getProcessStatus()) {
                                                            JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.INFORMATION_MESSAGE);
                                                            baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                        } else {
                                                            JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.ERROR_MESSAGE);
                                                        }
                                                    }
                                                    wait.setVisible(false);
                                                } catch (Exception e) {
                                                    e.printStackTrace();
                                                }
                                                try {
                                                    new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน opae74 แบบ บางฟังก์ชั่นการทำงาน ", NetUtils.getIpAddress(), 1);
                                                } catch (UnknownHostException ex) {
                                                    Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                                }
                                            }
                                        });
                                        thread.start();
                                    }
                                    
                                } else {
                                    JOptionPane.showMessageDialog(this,
                                            Constants.MSG_FILE_LOCATION_PLEASE,
                                            Constants.MSG_FILE_LOCATION,
                                            JOptionPane.ERROR_MESSAGE);
                                }
                            } else {
                                JOptionPane.showMessageDialog(this,
                                        Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                        Constants.MSG_SELECT_DATA,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    "กรุณาเลือกรูปแบบการออกรายงาน (รายละเอียด/สรุป/itemdetail/ค่าพาหนะ)",
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                "กรุณาเลือกรูปแบบ พิเศษ 1 ไฟล์ 1 hcode แยกเดือน | 1 ไฟล์ 1 hcode | 1 ไฟล์ ทุก hcode",
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_DATA,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_DATE_PLEASE,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btn74GenReportActionPerformed

    private void btn74GenReportAllFunctionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn74GenReportAllFunctionActionPerformed
        
        try {
            final DialogWaitProcess wait = new DialogWaitProcess();
            if (comboYearOpae74.getSelectedIndex() != 0) {
                if (comboNumOpae74.getSelectedIndex() != 0) {
                    if (radioAllHospitalOpae74.isSelected() || radioSingleHospitalOpae74.isSelected()) {
                        if (radioAllHospitalOpae74.isSelected() || radioSingleHospitalOpae74.isSelected() && listSelectHospital.size() > 0) {
                            if (!txtPathFileOpae74.getText().isEmpty()) {
                                int selectOption = JOptionPane.showConfirmDialog(null,
                                        Constants.MSG_REPORT_CONFIRM,
                                        Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                if (selectOption == JOptionPane.YES_OPTION) {
                                    wait.setVisible(true);
                                    
                                    Thread thread = new Thread(new Runnable() {
                                        @Override
                                        public void run() {
                                            ProgrameStatus programeStatus = new ProgrameStatus();
                                            try {
                                                wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                programeStatus = opae74Controller.opae74_genReportAllFunction(setInputFormReport());
                                                if (programeStatus.getProcessStatus()) {
                                                    JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                            Constants.MSG_REPORT_SUCCESS,
                                                            Constants.MSG_REPORT_COMPLETE, JOptionPane.INFORMATION_MESSAGE);
                                                    baseFunction.openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                    
                                                } else {
                                                    JOptionPane.showMessageDialog(UiReportOpae74.this,
                                                            Constants.MSG_CAN_NOT_REPORT_ERROR,
                                                            Constants.MSG_PROCESS_FAILS,
                                                            JOptionPane.ERROR_MESSAGE);
                                                }
                                                wait.setVisible(false);
                                            } catch (Exception e) {
                                                e.printStackTrace();
                                            }
                                            try {
                                                new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน opae74 แบบ ฟังก์ชั้นการทำงานทั้งหมด ", NetUtils.getIpAddress(), 1);
                                            } catch (UnknownHostException ex) {
                                                Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                            }
                                        }
                                    });
                                    thread.start();
                                    
                                }
                            } else {
                                JOptionPane.showMessageDialog(this,
                                        Constants.MSG_FILE_LOCATION_PLEASE,
                                        Constants.MSG_FILE_LOCATION,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                Constants.MSG_HOSPITAL_ATTRIBUTE,
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_DATA,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_NO,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btn74GenReportAllFunctionActionPerformed
    public void loadCombo() {
        try {
            //Tab Opae74
            //get Stmp From Table Rpt_Opbkk_opae74
            comboYearOpae74.removeAllItems();
            comboYearOpae74.addItem("-");
            listStmpOpae74 = new UtilDao().getStmpDistinct("RPT_OPBKK_OPAE74", "STMP");
            
            List<String> listOpae74 = new ArrayList<String>();
            
            for (int i = 0; i < listStmpOpae74.size(); i++) {
                listOpae74.add(listStmpOpae74.get(i).getStmpYM());
            }
            Collections.sort(listOpae74);
            for (String string : listOpae74) {
                comboYearOpae74.addItem(string);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
    
    public OppReport setInputFormReport() {
        OppReport report = new OppReport();
        report.setYearMonth(comboYearOpae74.getSelectedItem().toString());
        report.setNo(comboNumOpae74.getSelectedItem().toString());
        report.setPathFile(txtPathFileOpae74.getText());
        if (radioDetailOpae74.isSelected()) {
            report.setReportType(0);
        } else if (radioSumOpae74.isSelected()) {
            report.setReportType(1);
        } else if (radioItemDetail.isSelected()) {
            report.setReportType(2);
        } else if (radioCar.isSelected()) {
            report.setReportType(3);
        }
        if (checkOpae74_rehap.isSelected()) {
            report.setAttribute('R');  // rehap
        }
        if (radioSingleHospitalOpae74.isSelected()) {
            //report.setServiceCode(txtHCodeOpae74.getText());
            report.setListServiceCode(listSelectHospital);
        }
        
        report.setMonth(baseFunction.subStringYearMonth(comboYearOpae74.getSelectedItem().toString()).get("M").toString());
        report.setYear(baseFunction.subStringYearMonth(comboYearOpae74.getSelectedItem().toString()).get("Y").toString());
        report.setTitle1(txtTitle1.getText());
        report.setTitle2(txtTitle2.getText());
        report.setTitle3(txtFooter1.getText());
        if (radioForUse_Genaral.isSelected()) {
            report.setFor_use(0);
        } else if (radioForUse_Website.isSelected()) {
            report.setFor_use(1);
        }
        if (comboLookupYear.getSelectedIndex() == 0) {
            report.setBudget_year("");
        } else {
            report.setBudget_year(String.valueOf(comboLookupYear.getSelectedItem()));
        }
        report.setBudget_date(comboYearOpae74.getSelectedItem().toString());
        report.setBudget_stmp(comboYearOpae74.getSelectedItem().toString() + "-" + comboNumOpae74.getSelectedItem().toString());
        return report;
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btn74ChooseHospital;
    private javax.swing.JButton btn74GenReport;
    private javax.swing.JButton btn74GenReportAllFunction;
    private javax.swing.JButton btn74PathFile;
    private javax.swing.JButton btn74PathFileDesktop;
    private javax.swing.JCheckBox checkOpae74_rehap;
    private javax.swing.JComboBox comboLookupYear;
    private javax.swing.JComboBox comboNumOpae74;
    private javax.swing.JComboBox comboYearOpae74;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel19;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel25;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel45;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane8;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.ButtonGroup rGroup74Hospital;
    private javax.swing.ButtonGroup rGroup74Type;
    private javax.swing.ButtonGroup rGroupOpae74ForUse;
    private javax.swing.ButtonGroup rGroupOpae74_special;
    private javax.swing.JRadioButton radioAllHospitalOpae74;
    private javax.swing.JRadioButton radioCar;
    private javax.swing.JRadioButton radioDetailOpae74;
    private javax.swing.JRadioButton radioForUse_Genaral;
    private javax.swing.JRadioButton radioForUse_Website;
    private javax.swing.JRadioButton radioItemDetail;
    private javax.swing.JRadioButton radioSingleHospitalOpae74;
    private javax.swing.JRadioButton radioSumOpae74;
    private javax.swing.JRadioButton radio_special_opae74_1;
    private javax.swing.JRadioButton radio_special_opae74_2;
    private javax.swing.JRadioButton radio_special_opae74_all;
    private javax.swing.JPanel tabOpae74;
    public static javax.swing.JTextField txtFooter1;
    private javax.swing.JTextArea txtHnameOpae74;
    private javax.swing.JTextField txtPathFileOpae74;
    public static javax.swing.JTextArea txtTitle1;
    public static javax.swing.JTextField txtTitle2;
    // End of variables declaration//GEN-END:variables
}
