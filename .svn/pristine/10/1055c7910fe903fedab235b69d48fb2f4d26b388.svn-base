/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.claim.ui;

import com.claim.controller.LogAppController;
import com.claim.controller.OpIndividualController;
import com.claim.dao.UtilDao;
import com.claim.object.HospitalService;
import com.claim.object.OppReport;
import com.claim.object.Stmp;
import com.claim.support.BaseFunction;
import com.claim.support.Console;
import com.claim.support.Constants;
import com.claim.support.NetUtils;
import com.claim.support.ProgrameStatus;
import com.claim.dialog.DialogWaitProcess;
import java.awt.event.ItemEvent;
import java.io.File;
import java.net.UnknownHostException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

/**
 *
 * @author Poolsawat.a
 */
public class UiReportIndividual extends javax.swing.JInternalFrame {

    /**
     * Creates new form UiReportIndividual
     */
    private OpIndividualController individualController;    
    List<HospitalService> listSelectHospital = null;
    List<Stmp> listStmpIndv = null;

    public UiReportIndividual() {
        initComponents();
        this.individualController = new OpIndividualController();
        listSelectHospital = new ArrayList<HospitalService>();
        listStmpIndv = new ArrayList<Stmp>();
        this.loadCombo();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        rGroupIndType = new javax.swing.ButtonGroup();
        rGroupIndiHospital = new javax.swing.ButtonGroup();
        rGroupIndi_special = new javax.swing.ButtonGroup();
        rGroupIndiForUse = new javax.swing.ButtonGroup();
        rGroupIndiForIndvLate = new javax.swing.ButtonGroup();
        jPanel20 = new javax.swing.JPanel();
        jPanel21 = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();
        comboYearOpaeIndv = new javax.swing.JComboBox();
        jLabel6 = new javax.swing.JLabel();
        comboNumOpaeIndv = new javax.swing.JComboBox();
        jPanel22 = new javax.swing.JPanel();
        radioDetailOpaeIndv = new javax.swing.JRadioButton();
        radioSumOpaeIndv = new javax.swing.JRadioButton();
        jPanel23 = new javax.swing.JPanel();
        radioAllHospitalOpaeIndv = new javax.swing.JRadioButton();
        radioSingleHospitalOpaeIndv = new javax.swing.JRadioButton();
        btnIndiChooseHospital = new javax.swing.JButton();
        jScrollPane10 = new javax.swing.JScrollPane();
        txtHnameOpaeIndv = new javax.swing.JTextArea();
        jPanel24 = new javax.swing.JPanel();
        btnIndiPathFile = new javax.swing.JButton();
        txtPathFileOpaeIndv = new javax.swing.JTextField();
        btnIndiviPathFileDesktop = new javax.swing.JButton();
        jPanel34 = new javax.swing.JPanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        txtTitle1 = new javax.swing.JTextField();
        jPanel2 = new javax.swing.JPanel();
        txtTitle2 = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        txtFooter1 = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        txtFooter2 = new javax.swing.JTextField();
        jPanel6 = new javax.swing.JPanel();
        txtFooter3 = new javax.swing.JTextField();
        jPanel46 = new javax.swing.JPanel();
        radio_special_indv_1 = new javax.swing.JRadioButton();
        radio_special_indv_all = new javax.swing.JRadioButton();
        jPanel25 = new javax.swing.JPanel();
        radioIndvLate6 = new javax.swing.JRadioButton();
        radioIndvLate1 = new javax.swing.JRadioButton();
        radioIndvLate6And1 = new javax.swing.JRadioButton();
        tools = new javax.swing.JPanel();
        btnIndiGenReport = new javax.swing.JButton();
        btnIndiGenReportAllFunction = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        radioForUse_Genaral = new javax.swing.JRadioButton();
        radioForUse_Website = new javax.swing.JRadioButton();
        jPanel10 = new javax.swing.JPanel();
        comboLookupYear = new javax.swing.JComboBox();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("หน้าจอออกรายงาน Individual");
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Excel-icon.png"))); // NOI18N
        setPreferredSize(new java.awt.Dimension(1200, 550));

        jPanel21.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "งวดการจ่ายเงิน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        jLabel4.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        jLabel4.setText("ปีเดือน");

        comboYearOpaeIndv.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        comboYearOpaeIndv.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboYearOpaeIndvItemStateChanged(evt);
            }
        });

        jLabel6.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        jLabel6.setText("งวดที่");

        comboNumOpaeIndv.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        comboNumOpaeIndv.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboNumOpaeIndvItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel21Layout = new javax.swing.GroupLayout(jPanel21);
        jPanel21.setLayout(jPanel21Layout);
        jPanel21Layout.setHorizontalGroup(
            jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel21Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 86, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboYearOpaeIndv, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(32, 32, 32)
                .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 86, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(comboNumOpaeIndv, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(29, Short.MAX_VALUE))
        );
        jPanel21Layout.setVerticalGroup(
            jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel21Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(comboYearOpaeIndv, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6)
                    .addComponent(comboNumOpaeIndv, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel22.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "สถานะการส่งข้อมูล", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 24))); // NOI18N

        rGroupIndType.add(radioDetailOpaeIndv);
        radioDetailOpaeIndv.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioDetailOpaeIndv.setText("รายงานแบบรายละเอียด");

        rGroupIndType.add(radioSumOpaeIndv);
        radioSumOpaeIndv.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioSumOpaeIndv.setText("รายงานแบบสรุป");
        radioSumOpaeIndv.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioSumOpaeIndvItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel22Layout = new javax.swing.GroupLayout(jPanel22);
        jPanel22.setLayout(jPanel22Layout);
        jPanel22Layout.setHorizontalGroup(
            jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel22Layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(radioDetailOpaeIndv, javax.swing.GroupLayout.PREFERRED_SIZE, 179, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(radioSumOpaeIndv, javax.swing.GroupLayout.PREFERRED_SIZE, 143, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel22Layout.setVerticalGroup(
            jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel22Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioDetailOpaeIndv)
                    .addComponent(radioSumOpaeIndv))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel23.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "หน่วยให้บริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel23.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        rGroupIndiHospital.add(radioAllHospitalOpaeIndv);
        radioAllHospitalOpaeIndv.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioAllHospitalOpaeIndv.setText("หน่วยให้บริการทั้งหมด");
        radioAllHospitalOpaeIndv.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioAllHospitalOpaeIndvItemStateChanged(evt);
            }
        });
        jPanel23.add(radioAllHospitalOpaeIndv, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 20, -1, -1));

        rGroupIndiHospital.add(radioSingleHospitalOpaeIndv);
        radioSingleHospitalOpaeIndv.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioSingleHospitalOpaeIndv.setText("เลือกบางหน่วยให้บริการ");
        radioSingleHospitalOpaeIndv.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                radioSingleHospitalOpaeIndvActionPerformed(evt);
            }
        });
        jPanel23.add(radioSingleHospitalOpaeIndv, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 60, -1, -1));

        btnIndiChooseHospital.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        btnIndiChooseHospital.setText("เลือก");
        btnIndiChooseHospital.setEnabled(false);
        btnIndiChooseHospital.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnIndiChooseHospitalActionPerformed(evt);
            }
        });
        jPanel23.add(btnIndiChooseHospital, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 60, -1, -1));

        txtHnameOpaeIndv.setColumns(20);
        txtHnameOpaeIndv.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        txtHnameOpaeIndv.setLineWrap(true);
        txtHnameOpaeIndv.setRows(5);
        txtHnameOpaeIndv.setEnabled(false);
        jScrollPane10.setViewportView(txtHnameOpaeIndv);

        jPanel23.add(jScrollPane10, new org.netbeans.lib.awtextra.AbsoluteConstraints(310, 20, 550, 80));

        jPanel24.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "สถานที่เก็บไฟล์", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        btnIndiPathFile.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        btnIndiPathFile.setText("เลือก");
        btnIndiPathFile.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnIndiPathFileActionPerformed(evt);
            }
        });

        txtPathFileOpaeIndv.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        txtPathFileOpaeIndv.setEnabled(false);

        btnIndiviPathFileDesktop.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        btnIndiviPathFileDesktop.setText("desktop");
        btnIndiviPathFileDesktop.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnIndiviPathFileDesktopjButtonFolderActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel24Layout = new javax.swing.GroupLayout(jPanel24);
        jPanel24.setLayout(jPanel24Layout);
        jPanel24Layout.setHorizontalGroup(
            jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel24Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(btnIndiviPathFileDesktop)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnIndiPathFile)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtPathFileOpaeIndv, javax.swing.GroupLayout.PREFERRED_SIZE, 675, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(111, 111, 111))
        );
        jPanel24Layout.setVerticalGroup(
            jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel24Layout.createSequentialGroup()
                .addGroup(jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnIndiPathFile)
                    .addComponent(txtPathFileOpaeIndv, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnIndiviPathFileDesktop))
                .addGap(0, 13, Short.MAX_VALUE))
        );

        jPanel34.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ตัวอย่างแสดง หัวรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        jPanel34.setAutoscrolls(true);

        jTabbedPane1.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle1, javax.swing.GroupLayout.DEFAULT_SIZE, 817, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle1, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("หัวรายงานบนสุด", jPanel1);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle2, javax.swing.GroupLayout.DEFAULT_SIZE, 817, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtTitle2, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("หัวรายงานรอง", jPanel2);

        txtFooter1.setText("หมายเหตุ");

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter1, javax.swing.GroupLayout.DEFAULT_SIZE, 817, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter1, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("ท้ายรายงาน1", jPanel4);

        txtFooter2.setText("1. ปีงบประมาณ 2557 สำนักงานหลักประกันสุขภาพแห่งชาติ  เขต 13 กรุงเทพมหานคร กำหนดหลักเกณฑ์การจ่ายชดเชยค่าข้อมูลการบริการผู้ป่วยนอกรายบุคคล (OP Individual) วันละ 1 visit");

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter2, javax.swing.GroupLayout.DEFAULT_SIZE, 817, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter2, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("ท้ายรายงาน2", jPanel5);

        txtFooter3.setText("2.การจ่ายค่าข้อมูล ในปีงบประมาณ 2557 ที่มีการจ่ายซ้ำ/เกิน เกิดจากหน่วยบริการส่งข้อมูล OP Individual มากกว่า 1 visit ใน 1 วัน และโปรแกรมมีการประมวลผลคลาดเคลื่อนจากเงื่อนไขที่กำหนด");

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter3, javax.swing.GroupLayout.DEFAULT_SIZE, 817, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtFooter3, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("ท้ายรายงาน3", jPanel6);

        javax.swing.GroupLayout jPanel34Layout = new javax.swing.GroupLayout(jPanel34);
        jPanel34.setLayout(jPanel34Layout);
        jPanel34Layout.setHorizontalGroup(
            jPanel34Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel34Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane1)
                .addContainerGap())
        );
        jPanel34Layout.setVerticalGroup(
            jPanel34Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel34Layout.createSequentialGroup()
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        jPanel46.setBackground(new java.awt.Color(255, 208, 208));
        jPanel46.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "พิเศษ รายละเอียด", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        radio_special_indv_1.setBackground(new java.awt.Color(74, 205, 255));
        rGroupIndi_special.add(radio_special_indv_1);
        radio_special_indv_1.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radio_special_indv_1.setSelected(true);
        radio_special_indv_1.setText("1 ไฟล์ 1 hcode");

        radio_special_indv_all.setBackground(new java.awt.Color(157, 255, 110));
        rGroupIndi_special.add(radio_special_indv_all);
        radio_special_indv_all.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radio_special_indv_all.setText("1 ไฟล์ ทุก hcode");

        javax.swing.GroupLayout jPanel46Layout = new javax.swing.GroupLayout(jPanel46);
        jPanel46.setLayout(jPanel46Layout);
        jPanel46Layout.setHorizontalGroup(
            jPanel46Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel46Layout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addComponent(radio_special_indv_1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(radio_special_indv_all)
                .addContainerGap())
        );
        jPanel46Layout.setVerticalGroup(
            jPanel46Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel46Layout.createSequentialGroup()
                .addGroup(jPanel46Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radio_special_indv_1)
                    .addComponent(radio_special_indv_all))
                .addGap(0, 21, Short.MAX_VALUE))
        );

        jPanel25.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "สถานะการส่งข้อมูล", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 24))); // NOI18N
        jPanel25.setToolTipText("<html><h3>สำหรับงวดการออกรายงานที่มีทั้งส่งข้อมูลทันเวลาและไม่ทันเวลา <br/> สามาถเลือกออกรายงานได้ว่าอยากได้ข้อมูลแบบไหน</h3></html>");

        rGroupIndiForIndvLate.add(radioIndvLate6);
        radioIndvLate6.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioIndvLate6.setText("ทันเวลา 6 บาท");

        rGroupIndiForIndvLate.add(radioIndvLate1);
        radioIndvLate1.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioIndvLate1.setText("ล่าช้า 1 บาท");
        radioIndvLate1.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioIndvLate1ItemStateChanged(evt);
            }
        });

        rGroupIndiForIndvLate.add(radioIndvLate6And1);
        radioIndvLate6And1.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioIndvLate6And1.setSelected(true);
        radioIndvLate6And1.setText("ทุกสถานะการส่งข้อมูล");
        radioIndvLate6And1.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                radioIndvLate6And1ItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel25Layout = new javax.swing.GroupLayout(jPanel25);
        jPanel25.setLayout(jPanel25Layout);
        jPanel25Layout.setHorizontalGroup(
            jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addComponent(radioIndvLate6, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(radioIndvLate1, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(radioIndvLate6And1)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel25Layout.setVerticalGroup(
            jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(radioIndvLate6)
                    .addComponent(radioIndvLate1)
                    .addComponent(radioIndvLate6And1))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel20Layout = new javax.swing.GroupLayout(jPanel20);
        jPanel20.setLayout(jPanel20Layout);
        jPanel20Layout.setHorizontalGroup(
            jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel20Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel20Layout.createSequentialGroup()
                        .addGroup(jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jPanel23, javax.swing.GroupLayout.DEFAULT_SIZE, 874, Short.MAX_VALUE)
                            .addComponent(jPanel24, javax.swing.GroupLayout.PREFERRED_SIZE, 874, Short.MAX_VALUE))
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel20Layout.createSequentialGroup()
                        .addGroup(jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel20Layout.createSequentialGroup()
                                .addGroup(jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel20Layout.createSequentialGroup()
                                        .addComponent(jPanel21, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(18, 18, 18)
                                        .addComponent(jPanel46, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                    .addComponent(jPanel34, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(0, 0, Short.MAX_VALUE))
                            .addGroup(jPanel20Layout.createSequentialGroup()
                                .addComponent(jPanel22, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jPanel25, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                        .addGap(10, 10, 10))))
        );
        jPanel20Layout.setVerticalGroup(
            jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel20Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel21, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel46, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel34, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel22, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel25, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel23, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel24, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        tools.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "เครื่องมือการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N
        tools.setPreferredSize(new java.awt.Dimension(215, 445));

        btnIndiGenReport.setBackground(new java.awt.Color(153, 153, 255));
        btnIndiGenReport.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        btnIndiGenReport.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btnIndiGenReport.setText("ออกรายงาน");
        btnIndiGenReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnIndiGenReportActionPerformed(evt);
            }
        });

        btnIndiGenReportAllFunction.setBackground(new java.awt.Color(255, 204, 0));
        btnIndiGenReportAllFunction.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        btnIndiGenReportAllFunction.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Print-icon.png"))); // NOI18N
        btnIndiGenReportAllFunction.setText("<html>ออกรายงานทุกอย่าง<br />+ Website</html>");
        btnIndiGenReportAllFunction.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnIndiGenReportAllFunctionActionPerformed(evt);
            }
        });

        jPanel3.setBackground(new java.awt.Color(255, 255, 204));
        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ใช้เพื่อ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        rGroupIndiForUse.add(radioForUse_Genaral);
        radioForUse_Genaral.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioForUse_Genaral.setSelected(true);
        radioForUse_Genaral.setText("ทั่วไป");

        rGroupIndiForUse.add(radioForUse_Website);
        radioForUse_Website.setFont(new java.awt.Font("TH SarabunPSK", 1, 22)); // NOI18N
        radioForUse_Website.setText("อัพโหลด web site");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(radioForUse_Genaral)
                    .addComponent(radioForUse_Website))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(radioForUse_Genaral)
                .addGap(18, 18, 18)
                .addComponent(radioForUse_Website)
                .addContainerGap(18, Short.MAX_VALUE))
        );

        jPanel10.setBackground(new java.awt.Color(255, 255, 204));
        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ข้อมูลปีการออกรายงาน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 14))); // NOI18N

        comboLookupYear.setFont(new java.awt.Font("TH SarabunPSK", 1, 20)); // NOI18N
        comboLookupYear.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "รวมทุกปีงบ", "2015", "2014", "2013", "2012", "2011", "2010" }));

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, 142, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(22, Short.MAX_VALUE))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(comboLookupYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(29, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout toolsLayout = new javax.swing.GroupLayout(tools);
        tools.setLayout(toolsLayout);
        toolsLayout.setHorizontalGroup(
            toolsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(toolsLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(toolsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnIndiGenReportAllFunction, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnIndiGenReport, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        toolsLayout.setVerticalGroup(
            toolsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, toolsLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(31, 31, 31)
                .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 43, Short.MAX_VALUE)
                .addComponent(btnIndiGenReport, javax.swing.GroupLayout.PREFERRED_SIZE, 46, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(btnIndiGenReportAllFunction, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel20, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tools, javax.swing.GroupLayout.PREFERRED_SIZE, 228, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(46, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel20, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(tools, javax.swing.GroupLayout.PREFERRED_SIZE, 466, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void comboYearOpaeIndvItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboYearOpaeIndvItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            //txtTitleTimeIndivi.setText(baseFunction.getTitleTimeReport(comboYearOpaeIndv.getSelectedItem(), comboNumOpaeIndv.getSelectedItem()));
            comboNumOpaeIndv.removeAllItems();
            comboNumOpaeIndv.addItem("-");
            for (Stmp stmp : listStmpIndv) {
                //System.out.println("comboYearOpaeIndv.getSelectedItem()++"+comboYearOpaeIndv.getSelectedItem());
                //System.out.println("stmp.getStmpYM()++"+stmp.getStmpYM());
                if (comboYearOpaeIndv.getSelectedItem().equals(stmp.getStmpYM())
                        && comboNumOpaeIndv.getSelectedItem() != stmp.getStmpN()) {
                    comboNumOpaeIndv.addItem(stmp.getStmpN());
                }
            }
        }
    }//GEN-LAST:event_comboYearOpaeIndvItemStateChanged

    private void comboNumOpaeIndvItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboNumOpaeIndvItemStateChanged
        //txtTitleTimeIndivi.setText(baseFunction.getTitleTimeReport(comboYearOpaeIndv.getSelectedItem(), comboNumOpaeIndv.getSelectedItem()));
        txtTitle1.setText(individualController.execellHeaderMonth(comboYearOpaeIndv.getSelectedItem() + "-" + comboNumOpaeIndv.getSelectedItem()));
    }//GEN-LAST:event_comboNumOpaeIndvItemStateChanged

    private void radioSumOpaeIndvItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioSumOpaeIndvItemStateChanged
        if (radioSumOpaeIndv.isSelected()) {
            radioSingleHospitalOpaeIndv.setEnabled(false);
            btnIndiChooseHospital.setEnabled(false);
            radioAllHospitalOpaeIndv.setSelected(true);
        } else {
            radioSingleHospitalOpaeIndv.setEnabled(true);
            // btnIndiChooseHospital.setEnabled(true);
        }
    }//GEN-LAST:event_radioSumOpaeIndvItemStateChanged

    private void radioAllHospitalOpaeIndvItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioAllHospitalOpaeIndvItemStateChanged
        if (radioAllHospitalOpaeIndv.isSelected()) {
            btnIndiChooseHospital.setEnabled(false);
            //txtHCodeOpaeIndv.setText("");
            txtHnameOpaeIndv.setText("");
        } else {
            radioAllHospitalOpaeIndv.setEnabled(true);
        }
    }//GEN-LAST:event_radioAllHospitalOpaeIndvItemStateChanged

    private void radioSingleHospitalOpaeIndvActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_radioSingleHospitalOpaeIndvActionPerformed
        if (radioSingleHospitalOpaeIndv.isSelected()) {
            btnIndiChooseHospital.setEnabled(true);
        } else {
            radioSingleHospitalOpaeIndv.setEnabled(true);
        }
    }//GEN-LAST:event_radioSingleHospitalOpaeIndvActionPerformed

    private void btnIndiChooseHospitalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnIndiChooseHospitalActionPerformed
        txtHnameOpaeIndv.setText("");
        HashMap mapParam = new HashMap();
        mapParam.put("type", "individual");
        //mapParam.put("code", txtHCodeOpaeIndv);
        mapParam.put("name", txtHnameOpaeIndv);
        mapParam.put("listHospital", listSelectHospital);
        DialogService dialog = new DialogService();
        dialog.DialogServiceJInternalFrame(this, closable, mapParam);

        dialog.setVisible(true);
    }//GEN-LAST:event_btnIndiChooseHospitalActionPerformed

    private void btnIndiPathFileActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnIndiPathFileActionPerformed
        try {
            JFileChooser fc = new JFileChooser();
            fc.setDialogTitle("Open Folder");
            fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            fc.setCurrentDirectory(new File(""));
            int result = fc.showOpenDialog(this);
            if (result == JFileChooser.APPROVE_OPTION) {
                File a = fc.getSelectedFile();
                // Path File method in this class
                String temp = a.getPath();
                txtPathFileOpaeIndv.setText(".");

                if (temp != null) {
                    txtPathFileOpaeIndv.setText(temp);
                    //txtPathFileOpaeIndv.setEnabled(true);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnIndiPathFileActionPerformed

    private void btnIndiviPathFileDesktopjButtonFolderActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnIndiviPathFileDesktopjButtonFolderActionPerformed
        try {
            String desktopPath = System.getProperty("user.home") + "\\" + "Desktop";
            System.out.println("pathDesktop==>>" + desktopPath);
            txtPathFileOpaeIndv.setText(desktopPath);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnIndiviPathFileDesktopjButtonFolderActionPerformed

    private void btnIndiGenReportActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnIndiGenReportActionPerformed
        final DialogWaitProcess waitArea = new DialogWaitProcess();
        try {
            if (comboYearOpaeIndv.getSelectedIndex() != 0) {
                if (comboNumOpaeIndv.getSelectedIndex() != 0) {
                    if (radioDetailOpaeIndv.isSelected() || radioSumOpaeIndv.isSelected()) {
                        if (radioAllHospitalOpaeIndv.isSelected() || radioSingleHospitalOpaeIndv.isSelected() && listSelectHospital.size() > 0) {
                            if (radioIndvLate1.isSelected() || radioIndvLate6.isSelected() || radioIndvLate6And1.isSelected()) {
                                if (!txtPathFileOpaeIndv.getText().isEmpty()) {
                                    int selectOption = JOptionPane.showConfirmDialog(null,
                                            "ยืนยันการออกรายงาน อาจจะใช้เวลานาน...",
                                            Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                    if (selectOption == JOptionPane.YES_OPTION) {
                                        waitArea.setVisible(true);

                                        Thread thread = new Thread(new Runnable() {
                                            @Override
                                            public void run() {
                                                ProgrameStatus programeStatus = new ProgrameStatus();
                                                try {
                                                    waitArea.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                    if (radioDetailOpaeIndv.isSelected()) { // รายละเอียด
                                                        if (radioForUse_Genaral.isSelected()) {
                                                            if (radio_special_indv_1.isSelected()) {
                                                                Console.LOG("กำลังออกรายงาน 1 ไฟล์ ต่อ 1 hcode อาจจะใช้เวลานาน กรุณารอ... ", 1);
                                                                // status = individualController.op_individual_detail_MutiSheet(setInputFormReport());
                                                                programeStatus = individualController.op_individual_detail_SplitFile_caseLimitRowExcell(setInputFormReport());
                                                            } else if (radio_special_indv_all.isSelected()) {
                                                                Console.LOG("กำลังออกรายงาน 1 ไฟล์ ทุก hcode อาจจะใช้เวลานาน กรุณารอ... ", 1);
                                                                programeStatus = individualController.op_individual_detail_allcode_spliteFile_65500(setInputFormReport());
                                                            } else {
                                                                System.out.println(" No Select ");
                                                            }
                                                        } else {
                                                            programeStatus = individualController.op_individual_detail_byHcode_1fileMutiSheet(setInputFormReport());
                                                        }

                                                        if (programeStatus.getProcessStatus()) {
                                                            JOptionPane.showMessageDialog(UiReportIndividual.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.INFORMATION_MESSAGE);
                                                            new BaseFunction().openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                        } else {
                                                            JOptionPane.showMessageDialog(UiReportIndividual.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.ERROR_MESSAGE);
                                                        }
                                                    } else { // สรุป
                                                        programeStatus = individualController.op_individual_sum(setInputFormReport());
                                                        if (programeStatus.getProcessStatus()) {
                                                            JOptionPane.showMessageDialog(UiReportIndividual.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.INFORMATION_MESSAGE);
                                                            new BaseFunction().openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                        } else {
                                                            JOptionPane.showMessageDialog(UiReportIndividual.this,
                                                                    programeStatus.getMessage(),
                                                                    programeStatus.getTitle(),
                                                                    JOptionPane.ERROR_MESSAGE);
                                                        }
                                                    }
                                                    waitArea.setVisible(false);
                                                } catch (Exception e) {
                                                    e.printStackTrace();
                                                }
                                                try {
                                                    new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน individual แบบ บางฟังก์ชั้นการทำงาน ", NetUtils.getIpAddress(), 1);
                                                } catch (UnknownHostException ex) {
                                                    Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                                }
                                            }
                                        });
                                        thread.start();
                                    }
                                } else {
                                    JOptionPane.showMessageDialog(this,
                                            Constants.MSG_FILE_LOCATION_PLEASE,
                                            Constants.MSG_FILE_LOCATION,
                                            JOptionPane.ERROR_MESSAGE);
                                }
                            } else {
                                JOptionPane.showMessageDialog(this, Constants.MSG_INDV_LATE_PLEASE,
                                        Constants.MSG_INDV_LATE,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                    Constants.MSG_ENTER_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                "กรุณาเลือกรูปแบบการออกรายงาน (รายละเอียด/สรุป)",
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            "กรุณาเลือกงวดที่",
                            Constants.MSG_SELECT_DATA,
                            JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_DATE_PLEASE,
                        Constants.MSG_SELECT_DATA,
                        JOptionPane.ERROR_MESSAGE);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnIndiGenReportActionPerformed

    private void btnIndiGenReportAllFunctionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnIndiGenReportAllFunctionActionPerformed

        try {
            final DialogWaitProcess wait = new DialogWaitProcess();
            if (comboYearOpaeIndv.getSelectedIndex() != 0) {
                if (comboNumOpaeIndv.getSelectedIndex() != 0) {
                    if (radioAllHospitalOpaeIndv.isSelected() || radioSingleHospitalOpaeIndv.isSelected()) {
                        if (radioAllHospitalOpaeIndv.isSelected() || radioSingleHospitalOpaeIndv.isSelected() && listSelectHospital.size() > 0) {
                            if (radioIndvLate1.isSelected() || radioIndvLate6.isSelected() || radioIndvLate6And1.isSelected()) {
                                if (!txtPathFileOpaeIndv.getText().isEmpty()) {
                                    int selectOption = JOptionPane.showConfirmDialog(null,
                                            Constants.MSG_REPORT_CONFIRM,
                                            Constants.MSG_REPORT_INFOMATION, JOptionPane.YES_NO_OPTION);
                                    if (selectOption == JOptionPane.YES_OPTION) {
                                        wait.setVisible(true);

                                        Thread thread = new Thread(new Runnable() {
                                            @Override
                                            public void run() {
                                                ProgrameStatus programeStatus = new ProgrameStatus();
                                                try {
                                                    wait.setTitle(Constants.MSG_PROGRAME_PROCESSSING);
                                                    programeStatus = individualController.op_genReportAllFunction(setInputFormReport());
                                                    if (programeStatus.getProcessStatus()) {
                                                        JOptionPane.showMessageDialog(UiReportIndividual.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.INFORMATION_MESSAGE);
                                                        new BaseFunction().openDirectoryAutomatic(setInputFormReport().getPathFile());
                                                    } else {
                                                        JOptionPane.showMessageDialog(UiReportIndividual.this,
                                                                programeStatus.getMessage(),
                                                                programeStatus.getTitle(),
                                                                JOptionPane.ERROR_MESSAGE);
                                                    }
                                                    wait.setVisible(false);
                                                } catch (Exception e) {
                                                    e.printStackTrace();
                                                }
                                                try {
                                                    new LogAppController().createLog("ทำการออกรายงาน", "ทำการออกรายงาน individual แบบ ฟังก์ชั้นการทำงานทั้งหมด ", NetUtils.getIpAddress(), 1);
                                                } catch (UnknownHostException ex) {
                                                    Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                                                }
                                            }
                                        });
                                        thread.start();
                                    }
                                } else {
                                    JOptionPane.showMessageDialog(this,
                                            Constants.MSG_FILE_LOCATION_PLEASE,
                                            Constants.MSG_FILE_LOCATION,
                                            JOptionPane.ERROR_MESSAGE);
                                }
                            } else {
                                JOptionPane.showMessageDialog(this, Constants.MSG_INDV_LATE_PLEASE,
                                        Constants.MSG_INDV_LATE,
                                        JOptionPane.ERROR_MESSAGE);
                            }
                        } else {
                            JOptionPane.showMessageDialog(this,
                                    Constants.MSG_HOSPITAL_SELECT_PLEASE,
                                    Constants.MSG_SELECT_DATA,
                                    JOptionPane.ERROR_MESSAGE);
                        }
                    } else {
                        JOptionPane.showMessageDialog(this,
                                Constants.MSG_HOSPITAL_ATTRIBUTE,
                                Constants.MSG_SELECT_DATA,
                                JOptionPane.ERROR_MESSAGE);
                    }
                } else {
                    JOptionPane.showMessageDialog(this,
                            Constants.MSG_SELECT_NO,
                            Constants.MSG_SELECT_DATA, JOptionPane.ERROR_MESSAGE);
                }
            } else {
                JOptionPane.showMessageDialog(this,
                        Constants.MSG_SELECT_NO,
                        Constants.MSG_SELECT_NO,
                        JOptionPane.ERROR_MESSAGE);
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnIndiGenReportAllFunctionActionPerformed

    private void radioIndvLate1ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioIndvLate1ItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_radioIndvLate1ItemStateChanged

    private void radioIndvLate6And1ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_radioIndvLate6And1ItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_radioIndvLate6And1ItemStateChanged
    private OppReport setInputFormReport() {
        OppReport report = null;
        try {
            report = new OppReport();
            report.setYearMonth(comboYearOpaeIndv.getSelectedItem().toString());
            report.setNo(comboNumOpaeIndv.getSelectedItem().toString());
            report.setPathFile(txtPathFileOpaeIndv.getText());
            if (radioDetailOpaeIndv.isSelected()) {
                report.setReportType(0);
            } else {
                report.setReportType(1);
            }
            if (radioSingleHospitalOpaeIndv.isSelected()) {
                //report.setServiceCode(txtHCodeOpaeIndv.getText());
                report.setListServiceCode(listSelectHospital);
            }
            report.setMonth(new BaseFunction().subStringYearMonth(comboYearOpaeIndv.getSelectedItem().toString()).get("M").toString());
            report.setYear(new BaseFunction().subStringYearMonth(comboYearOpaeIndv.getSelectedItem().toString()).get("Y").toString());
            report.setTitle1(txtTitle1.getText());
            /* if (checkboxDupiIndi.isSelected()) {
             report.setAttribute('Y'); // Y = Yes,N = No
             }*/
            report.setBudget_date(comboYearOpaeIndv.getSelectedItem().toString());
            if (radioForUse_Genaral.isSelected()) {
                report.setFor_use(0);
            } else if (radioForUse_Website.isSelected()) {
                report.setFor_use(1);
            }
            if (comboLookupYear.getSelectedIndex() == 0) {
                report.setBudget_year("");
            } else {
                report.setBudget_year(String.valueOf(comboLookupYear.getSelectedItem()));
            }
            report.setBudget_stmp(report.getYearMonth() + "-" + report.getNo());
            /*
             Modified by poolsawat 02-06-2015
            */
            if (radioIndvLate6.isSelected()) { // ทันเวลา 6 บาท
                report.setIndv_late("0");
            } else if (radioIndvLate1.isSelected()) { // ไม่ทันเวลา
                report.setIndv_late("1");
            } else { // ทั้งทันและม่ทันเวลา
                report.setIndv_late(null);
            }
            return report;
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }

    public void loadCombo() {
        try {
            //Tab Indv
            // get Stmp From Table Rpt_OpBkk_Indv
            comboYearOpaeIndv.removeAllItems();
            comboYearOpaeIndv.addItem("-");
            listStmpIndv = new UtilDao().getStmpDistinct("RPT_OPBKK_INDV", "STMP");

            List<String> listIndi = new ArrayList<String>();

            for (int i = 0; i < listStmpIndv.size(); i++) {
                listIndi.add(listStmpIndv.get(i).getStmpYM());
            }
            Collections.sort(listIndi);
            for (String string : listIndi) {
                comboYearOpaeIndv.addItem(string);
            }
        } catch (SQLException e) {
            e.printStackTrace();
            Console.LOG(e.getMessage(), 0);
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnIndiChooseHospital;
    private javax.swing.JButton btnIndiGenReport;
    private javax.swing.JButton btnIndiGenReportAllFunction;
    private javax.swing.JButton btnIndiPathFile;
    private javax.swing.JButton btnIndiviPathFileDesktop;
    private javax.swing.JComboBox comboLookupYear;
    private javax.swing.JComboBox comboNumOpaeIndv;
    private javax.swing.JComboBox comboYearOpaeIndv;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel20;
    private javax.swing.JPanel jPanel21;
    private javax.swing.JPanel jPanel22;
    private javax.swing.JPanel jPanel23;
    private javax.swing.JPanel jPanel24;
    private javax.swing.JPanel jPanel25;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel34;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel46;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JScrollPane jScrollPane10;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.ButtonGroup rGroupIndType;
    private javax.swing.ButtonGroup rGroupIndiForIndvLate;
    private javax.swing.ButtonGroup rGroupIndiForUse;
    private javax.swing.ButtonGroup rGroupIndiHospital;
    private javax.swing.ButtonGroup rGroupIndi_special;
    private javax.swing.JRadioButton radioAllHospitalOpaeIndv;
    private javax.swing.JRadioButton radioDetailOpaeIndv;
    private javax.swing.JRadioButton radioForUse_Genaral;
    private javax.swing.JRadioButton radioForUse_Website;
    private javax.swing.JRadioButton radioIndvLate1;
    private javax.swing.JRadioButton radioIndvLate6;
    private javax.swing.JRadioButton radioIndvLate6And1;
    private javax.swing.JRadioButton radioSingleHospitalOpaeIndv;
    private javax.swing.JRadioButton radioSumOpaeIndv;
    private javax.swing.JRadioButton radio_special_indv_1;
    private javax.swing.JRadioButton radio_special_indv_all;
    private javax.swing.JPanel tools;
    public static javax.swing.JTextField txtFooter1;
    public static javax.swing.JTextField txtFooter2;
    public static javax.swing.JTextField txtFooter3;
    private javax.swing.JTextArea txtHnameOpaeIndv;
    private javax.swing.JTextField txtPathFileOpaeIndv;
    public static javax.swing.JTextField txtTitle1;
    public static javax.swing.JTextField txtTitle2;
    // End of variables declaration//GEN-END:variables
}
