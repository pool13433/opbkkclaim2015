/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.claim.ui;

import com.claim.controller.CreateDataStoreController;
import com.claim.controller.LogAppController;
import com.claim.dao.UtilDao;
import com.claim.object.ObjCallStoreCreateData;
import com.claim.support.BaseFunction;
import com.claim.support.Console;
import com.claim.support.Constants;
import com.claim.support.NetUtils;
import com.claim.support.Picker;
import com.claim.support.ProgrameStatus;
import com.claim.dialog.DialogWaitProcess;
import com.claim.support.DateUtil;
import java.awt.event.ItemEvent;
import java.net.UnknownHostException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;

/**
 *
 * @author Poolsawat.a
 */
public class UiCreateDataHc extends javax.swing.JInternalFrame {

    private CreateDataStoreController createStoreController;
    boolean staCheck = false;
    

    /**
     * Creates new form UiCreateData
     */
    public UiCreateDataHc() {
        initComponents();
        this.createStoreController = new CreateDataStoreController();
        this.loadComboCreateData();
        this.loadTextBoxDate();
    }
    private void loadTextBoxDate(){
        txt_opdStart.setText(DateUtil.DATE_DEFAULT_HC);
        //txt_sendStart.setText("20141001");
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        rGroupIndv_late = new javax.swing.ButtonGroup();
        rGroupOpae74_Option = new javax.swing.ButtonGroup();
        rGroup_Process = new javax.swing.ButtonGroup();
        rGroupRefer_Option = new javax.swing.ButtonGroup();
        jPanel37 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        comboCreateTable = new javax.swing.JComboBox();
        lb_error1 = new javax.swing.JLabel();
        jPanelOpd = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        btn_opdStart = new javax.swing.JButton();
        btn_opdStop = new javax.swing.JButton();
        jLabel14 = new javax.swing.JLabel();
        txt_opdStart = new javax.swing.JTextField();
        txt_opdStop = new javax.swing.JTextField();
        lb_error2 = new javax.swing.JLabel();
        lb_error3 = new javax.swing.JLabel();
        jPanelSend = new javax.swing.JPanel();
        jLabel15 = new javax.swing.JLabel();
        btn_sendStart = new javax.swing.JButton();
        btn_sendStop = new javax.swing.JButton();
        jLabel16 = new javax.swing.JLabel();
        txt_sendStart = new javax.swing.JTextField();
        txt_sendStop = new javax.swing.JTextField();
        lb_error4 = new javax.swing.JLabel();
        lb_error5 = new javax.swing.JLabel();
        btnCreateData = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        txt_begin_money = new javax.swing.JTextField();
        lb_error6 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        comboStmpNoRound = new javax.swing.JComboBox();
        lb_error7 = new javax.swing.JLabel();
        comboStmpNoYear = new javax.swing.JComboBox();
        comboStmpNoMonth = new javax.swing.JComboBox();
        jLabel37 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        lb_error8 = new javax.swing.JLabel();
        lb_error9 = new javax.swing.JLabel();
        txt_stmp_no = new javax.swing.JComboBox();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("หน้าจอสร้างข้อมูลการออกรายงาน OPศบส.- วชิรฯ");
        setAutoscrolls(true);
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/Excel-icon.png"))); // NOI18N
        setPreferredSize(new java.awt.Dimension(1250, 500));

        jPanel37.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ประเภทบริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 24))); // NOI18N

        jLabel1.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        jLabel1.setText("ชื่อตาราง: ");

        comboCreateTable.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N

        lb_error1.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error1.setForeground(new java.awt.Color(255, 0, 51));
        lb_error1.setText("*");

        javax.swing.GroupLayout jPanel37Layout = new javax.swing.GroupLayout(jPanel37);
        jPanel37.setLayout(jPanel37Layout);
        jPanel37Layout.setHorizontalGroup(
            jPanel37Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel37Layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel37Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lb_error1, javax.swing.GroupLayout.PREFERRED_SIZE, 336, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(comboCreateTable, javax.swing.GroupLayout.PREFERRED_SIZE, 368, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel37Layout.setVerticalGroup(
            jPanel37Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel37Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel37Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(comboCreateTable, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel1))
                .addGap(18, 18, 18)
                .addComponent(lb_error1)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanelOpd.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "วันรับบริการ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 24))); // NOI18N

        jLabel3.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        jLabel3.setText("ตั้งแต่:");

        btn_opdStart.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        btn_opdStart.setText("เลือก");
        btn_opdStart.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btn_opdStartMouseClicked(evt);
            }
        });

        btn_opdStop.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        btn_opdStop.setText("เลือก");
        btn_opdStop.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btn_opdStopMouseClicked(evt);
            }
        });

        jLabel14.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        jLabel14.setText("ถึง: ");

        txt_opdStart.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        txt_opdStart.setEnabled(false);

        txt_opdStop.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        txt_opdStop.setEnabled(false);

        lb_error2.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error2.setForeground(new java.awt.Color(255, 0, 51));
        lb_error2.setText("*");

        lb_error3.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error3.setForeground(new java.awt.Color(255, 0, 51));
        lb_error3.setText("*");

        javax.swing.GroupLayout jPanelOpdLayout = new javax.swing.GroupLayout(jPanelOpd);
        jPanelOpd.setLayout(jPanelOpdLayout);
        jPanelOpdLayout.setHorizontalGroup(
            jPanelOpdLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelOpdLayout.createSequentialGroup()
                .addGroup(jPanelOpdLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanelOpdLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel3)
                        .addGap(18, 18, 18)
                        .addComponent(txt_opdStart, javax.swing.GroupLayout.PREFERRED_SIZE, 116, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btn_opdStart))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanelOpdLayout.createSequentialGroup()
                        .addGap(72, 72, 72)
                        .addComponent(lb_error2, javax.swing.GroupLayout.PREFERRED_SIZE, 182, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addComponent(jLabel14)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanelOpdLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanelOpdLayout.createSequentialGroup()
                        .addComponent(txt_opdStop, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btn_opdStop))
                    .addComponent(lb_error3, javax.swing.GroupLayout.PREFERRED_SIZE, 193, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(67, Short.MAX_VALUE))
        );
        jPanelOpdLayout.setVerticalGroup(
            jPanelOpdLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelOpdLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanelOpdLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanelOpdLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel14)
                        .addComponent(txt_opdStop, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btn_opdStop))
                    .addGroup(jPanelOpdLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btn_opdStart)
                        .addComponent(txt_opdStart, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel3)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanelOpdLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lb_error2)
                    .addComponent(lb_error3)))
        );

        jPanelSend.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "วันที่ส่งข้อมูล", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 24))); // NOI18N
        jPanelSend.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N

        jLabel15.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        jLabel15.setText("ตั้งแต่: ");

        btn_sendStart.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        btn_sendStart.setText("เลือก");
        btn_sendStart.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btn_sendStartMouseClicked(evt);
            }
        });

        btn_sendStop.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        btn_sendStop.setText("เลือก");
        btn_sendStop.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btn_sendStopMouseClicked(evt);
            }
        });

        jLabel16.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        jLabel16.setText("ถึง: ");

        txt_sendStart.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        txt_sendStart.setEnabled(false);

        txt_sendStop.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        txt_sendStop.setEnabled(false);

        lb_error4.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error4.setForeground(new java.awt.Color(255, 0, 51));
        lb_error4.setText("*");

        lb_error5.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error5.setForeground(new java.awt.Color(255, 0, 51));
        lb_error5.setText("*");

        javax.swing.GroupLayout jPanelSendLayout = new javax.swing.GroupLayout(jPanelSend);
        jPanelSend.setLayout(jPanelSendLayout);
        jPanelSendLayout.setHorizontalGroup(
            jPanelSendLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelSendLayout.createSequentialGroup()
                .addGap(40, 40, 40)
                .addComponent(jLabel15)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanelSendLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(lb_error4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txt_sendStart, javax.swing.GroupLayout.DEFAULT_SIZE, 126, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_sendStart)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel16)
                .addGap(18, 18, 18)
                .addGroup(jPanelSendLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(lb_error5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txt_sendStop, javax.swing.GroupLayout.DEFAULT_SIZE, 107, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_sendStop)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanelSendLayout.setVerticalGroup(
            jPanelSendLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelSendLayout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(jPanelSendLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btn_sendStart)
                    .addComponent(btn_sendStop)
                    .addComponent(jLabel16)
                    .addComponent(txt_sendStop, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_sendStart, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel15))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanelSendLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lb_error5)
                    .addComponent(lb_error4))
                .addGap(0, 0, Short.MAX_VALUE))
        );

        btnCreateData.setBackground(new java.awt.Color(153, 255, 153));
        btnCreateData.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        btnCreateData.setForeground(new java.awt.Color(51, 51, 255));
        btnCreateData.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/claim/util/images/progressbar.png"))); // NOI18N
        btnCreateData.setText("เริ่มประมวลผล...");
        btnCreateData.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCreateDataActionPerformed(evt);
            }
        });

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "ใส่วงเงินตั้งต้น", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 24))); // NOI18N

        jLabel2.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        jLabel2.setText("วงเงินตั้งต้น");

        txt_begin_money.setFont(new java.awt.Font("TH SarabunPSK", 1, 18)); // NOI18N

        lb_error6.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error6.setForeground(new java.awt.Color(255, 0, 51));
        lb_error6.setText("*");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(lb_error6, javax.swing.GroupLayout.PREFERRED_SIZE, 397, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel2Layout.createSequentialGroup()
                        .addGap(39, 39, 39)
                        .addComponent(jLabel2)
                        .addGap(18, 18, 18)
                        .addComponent(txt_begin_money, javax.swing.GroupLayout.PREFERRED_SIZE, 352, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(42, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(txt_begin_money, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(lb_error6)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "กำหนดงวดการจ่ายเงิน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("TH SarabunPSK", 1, 24))); // NOI18N

        comboStmpNoRound.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N

        lb_error7.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error7.setForeground(new java.awt.Color(255, 0, 51));
        lb_error7.setText("*");

        comboStmpNoYear.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N

        comboStmpNoMonth.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        comboStmpNoMonth.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                comboStmpNoMonthItemStateChanged(evt);
            }
        });

        jLabel37.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        jLabel37.setText("งวดที่หรือครั้งที่: ");

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jLabel4.setText("-");

        lb_error8.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error8.setForeground(new java.awt.Color(255, 0, 51));
        lb_error8.setText("*");

        lb_error9.setFont(new java.awt.Font("TH SarabunPSK", 1, 14)); // NOI18N
        lb_error9.setForeground(new java.awt.Color(255, 0, 51));
        lb_error9.setText("*");

        txt_stmp_no.setFont(new java.awt.Font("TH SarabunPSK", 1, 24)); // NOI18N
        txt_stmp_no.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12" }));

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(comboStmpNoYear, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(comboStmpNoMonth, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(lb_error8, javax.swing.GroupLayout.PREFERRED_SIZE, 124, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 13, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(comboStmpNoRound, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(25, 25, 25)
                        .addComponent(jLabel37)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txt_stmp_no, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(lb_error7, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(34, 34, 34)
                        .addComponent(lb_error9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(comboStmpNoRound, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(comboStmpNoYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(comboStmpNoMonth, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel37)
                            .addComponent(jLabel4)))
                    .addComponent(txt_stmp_no))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lb_error8)
                    .addComponent(lb_error9)
                    .addComponent(lb_error7))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(21, 21, 21)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanelOpd, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel37, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(20, 20, 20)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanelSend, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnCreateData, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(69, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel37, javax.swing.GroupLayout.PREFERRED_SIZE, 123, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanelOpd, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanelSend, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(24, 24, 24)
                        .addComponent(btnCreateData, javax.swing.GroupLayout.PREFERRED_SIZE, 76, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(176, 176, 176))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btn_opdStartMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btn_opdStartMouseClicked
        HashMap mapParam = new HashMap();
        mapParam.put("btn", btn_opdStart);
        mapParam.put("txt", txt_opdStart);
        mapParam.put("panel", jPanelOpd);
        mapParam.put("formatDate", DateUtil.DATE_FORMAT);
        new Picker().PickerJInternal(this, mapParam);
    }//GEN-LAST:event_btn_opdStartMouseClicked

    private void btn_opdStopMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btn_opdStopMouseClicked
        HashMap mapParam = new HashMap();
        mapParam.put("btn", btn_opdStop);
        mapParam.put("txt", txt_opdStop);
        mapParam.put("panel", jPanelOpd);
        mapParam.put("formatDate", DateUtil.DATE_FORMAT);
        new Picker().PickerJInternal(this, mapParam);
    }//GEN-LAST:event_btn_opdStopMouseClicked

    private void btn_sendStartMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btn_sendStartMouseClicked
        HashMap mapParam = new HashMap();
        mapParam.put("btn", btn_sendStart);
        mapParam.put("txt", txt_sendStart);
        mapParam.put("panel", jPanelSend);
        mapParam.put("formatDate", DateUtil.DATE_FORMAT);
        new Picker().PickerJInternal(this, mapParam);
    }//GEN-LAST:event_btn_sendStartMouseClicked

    private void btn_sendStopMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btn_sendStopMouseClicked
        HashMap mapParam = new HashMap();
        mapParam.put("btn", btn_sendStop);
        mapParam.put("txt", txt_sendStop);
        mapParam.put("panel", jPanelSend);
        mapParam.put("formatDate", DateUtil.DATE_FORMAT);
        new Picker().PickerJInternal(this, mapParam);
    }//GEN-LAST:event_btn_sendStopMouseClicked

    private void btnCreateDataActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCreateDataActionPerformed
        final DialogWaitProcess f = new DialogWaitProcess();
        if (checkFormCreateData().isEmpty()) {

            final DialogWaitProcess frmCheck = new DialogWaitProcess();
            frmCheck.setVisible(true);
            frmCheck.setTitle("กำลังตรวจสอบ งวด stmp กรุณารอ...");

            Thread threadCheck = new Thread(new Runnable() {
                @Override
                public void run() {
                    int indexTable = comboCreateTable.getSelectedIndex();
                    String stmp = comboStmpNoYear.getSelectedItem() + "" + comboStmpNoMonth.getSelectedItem()
                            + "-" + String.valueOf(comboStmpNoRound.getSelectedIndex());
                    staCheck = createStoreController.checkCreateDataDupicate(setInputFormCreateData());
                    frmCheck.setVisible(false);

                    if (!staCheck) { // false = ไม่ซ้ำ
                        int selectOption = JOptionPane.showConfirmDialog(null,
                                "ยืนยันการประมวลผลโปรแกรม",
                                "Processing...", JOptionPane.YES_NO_OPTION);
                        if (selectOption == JOptionPane.YES_OPTION) {
                            try {
                                f.setVisible(true);

                                Thread thread = new Thread(new Runnable() {
                                    @Override
                                    public void run() {
                                        ProgrameStatus programeStatus = new ProgrameStatus();
                                        try {
                                            if (programeStatus.getProcessStatus()) {
                                                programeStatus = createStoreController.startRunStore(setInputFormCreateData());
                                                Console.LOG(" ผลของทางโปรแกรม: " + programeStatus.getMessage(), 1);
                                                Console.LOG(" ผลของฐานข้อมูล: " + createStoreController.getLogReport(comboCreateTable.getSelectedIndex()), 1);
                                                f.setVisible(false);
                                            } else {
                                                programeStatus = createStoreController.startRunStore(setInputFormCreateData());
                                                Console.LOG(" ผลของทางโปรแกรม: " + programeStatus.getMessage(), 1);
                                                Console.LOG(" ผลของฐานข้อมูล: " + createStoreController.getLogReport(comboCreateTable.getSelectedIndex()), 1);
                                                f.setVisible(false);
                                            }

                                        } catch (SQLException e) {
                                            e.printStackTrace();
                                        }
                                    }
                                });
                                thread.start();
                            } catch (Exception e) {
                                e.printStackTrace();
                            }
                        }

                    } else { // true = ซ้ำ
                        Console.LOG(" งวดการสร้างข้อมูลนี้ เคยทำการ ประมวลผลไปแล้ว", 0);
                        Console.LOG(" เงื่อนไข => จะประมวลผล ซ้ำ งวดเดิม ใช่ หรือ ไม่", 0);
                        /* JOptionPane.showMessageDialog(MainBkkTabReport.this,
                         "งวดการจ่ายเงินนี้ ได้ผ่านแจ้งสถานะการจ่ายเงินแล้ว",
                         "ไม่สามารถสร้างข้อมูล งวดการจ่ายเงินนี้ได้",
                         JOptionPane.ERROR_MESSAGE); */

                        int selectOption = JOptionPane.showConfirmDialog(null,
                                "งวดการจ่ายเงินนี้ ได้ผ่านการประมวลผล ไปแล้ว",
                                "ท่านจะ สร้างข้อมูลงวดนี้ ซ้ำ ใช่หรือไม่", JOptionPane.YES_NO_OPTION);
                        if (selectOption == JOptionPane.YES_OPTION) {
                            try {
                                f.setVisible(true);

                                Thread thread = new Thread(new Runnable() {
                                    @Override
                                    public void run() {
                                        ProgrameStatus programeStatus = new ProgrameStatus();
                                        try {
                                            if (programeStatus.getProcessStatus()) {
                                                programeStatus = createStoreController.startRunStore(setInputFormCreateData());
                                                Console.LOG(" ผลของทางโปรแกรม " + programeStatus.getMessage(), 1);
                                                Console.LOG(" ผลของฐานข้อมูล " + createStoreController.getLogReport(comboCreateTable.getSelectedIndex()), 1);
                                                f.setVisible(false);
                                            } else {
                                                programeStatus = createStoreController.startRunStore(setInputFormCreateData());
                                                Console.LOG(" ผลของทางโปรแกรม " + programeStatus.getMessage(), 1);
                                                Console.LOG(" ผลของฐานข้อมูล " + createStoreController.getLogReport(comboCreateTable.getSelectedIndex()), 1);
                                                f.setVisible(false);
                                            }

                                        } catch (SQLException e) {
                                            e.printStackTrace();
                                            Console.LOG(e.getMessage(), 0);
                                        }
                                    }
                                });
                                thread.start();
                            } catch (Exception e) {
                                e.printStackTrace();
                            }
                        }
                    }
                    try {
                        String desc = " ทำการสร้างข้อมูล " + BaseFunction.PROCE_CREATE_TABLE[comboCreateTable.getSelectedIndex()];
                        desc += " โดยมาค่าที่ ส่งเข้าไปคือ [ " + setInputFormCreateData().toString() + " ]";
                        new LogAppController().createLog("ทำการสร้างข้อมูล " + BaseFunction.PROCE_CREATE_TABLE[comboCreateTable.getSelectedIndex()], desc, NetUtils.getIpAddress(), 1);
                    } catch (UnknownHostException ex) {
                        Logger.getLogger(UiMainClaim.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            });
            threadCheck.start();
        } else {
            JOptionPane.showMessageDialog(this,
                    Constants.MSG_ENTER_DATA,
                    Constants.MSG_ENTER_DATA,
                    JOptionPane.ERROR_MESSAGE);
        }
    }//GEN-LAST:event_btnCreateDataActionPerformed

    private void comboStmpNoMonthItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comboStmpNoMonthItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            int[] round = new int[21];
            if (comboStmpNoMonth.getSelectedIndex() > 0) {
                for (int i = 0; i < round.length; i++) {
                    comboStmpNoRound.addItem(i);
                }
            }
        }
    }//GEN-LAST:event_comboStmpNoMonthItemStateChanged

    private ObjCallStoreCreateData setInputFormCreateData() {
        ObjCallStoreCreateData objData = new ObjCallStoreCreateData();
        objData.setIndex_table(comboCreateTable.getSelectedIndex());
        objData.setOpd_date_start(new DateUtil().changeDateFormat(txt_opdStart.getText(), DateUtil.DATE_FORMAT, DateUtil.DATE_FORMAT_TO));
        objData.setOpd_date_stop(new DateUtil().changeDateFormat(txt_opdStop.getText(), DateUtil.DATE_FORMAT, DateUtil.DATE_FORMAT_TO));
        objData.setOpd_send_start(new DateUtil().changeDateFormat(txt_sendStart.getText(), DateUtil.DATE_FORMAT, DateUtil.DATE_FORMAT_TO));
        objData.setOpd_send_stop(new DateUtil().changeDateFormat(txt_sendStop.getText(), DateUtil.DATE_FORMAT, DateUtil.DATE_FORMAT_TO));
        objData.setStmp(comboStmpNoYear.getSelectedItem() + "" + comboStmpNoMonth.getSelectedItem());
        objData.setStmp_round(String.valueOf(comboStmpNoRound.getSelectedIndex()));
        objData.setStmp_no(String.valueOf(txt_stmp_no.getSelectedItem()));
        
        objData.setStmpyyyymm_no(comboStmpNoYear.getSelectedItem() + "" + comboStmpNoMonth.getSelectedItem() + "-" + String.valueOf(comboStmpNoRound.getSelectedIndex()));
        objData.setStmpyyyymmno((comboStmpNoYear.getSelectedItem() + "" + comboStmpNoMonth.getSelectedItem() + "" + String.valueOf(comboStmpNoRound.getSelectedIndex())));

       
        return objData;
    }

    private void loadComboCreateData() {
        String[] arrTable = BaseFunction.PROCE_CREATE_TABLE_HC;
        for (String strTable : arrTable) {
            comboCreateTable.addItem(strTable);
        }
        String[] arrMonth = BaseFunction.INDEX_MONTH;
        for (int i = 0; i < arrMonth.length; i++) {
            comboStmpNoMonth.addItem(arrMonth[i]);
        }
        int[] arrYear = BaseFunction.INDEX_YEAR(3);
        for (int i = 0; i < arrYear.length; i++) {
            comboStmpNoYear.addItem(String.valueOf(arrYear[i]));
        }
        String currentYear = new UtilDao().getCurrentYearFromServer();
        System.out.println("currentYear ::=="+currentYear);
        comboStmpNoYear.setSelectedItem(currentYear);
    }

    private List<Integer> checkFormCreateData() {
        List<Integer> error = new ArrayList<Integer>();
        if (comboCreateTable.getSelectedIndex() == 0) {
            error.add(1);
            lb_error1.setText(Constants.MSG_SELECT_DATA);
        } else {
            lb_error1.setText("");
        }
        if (txt_opdStart.getText().isEmpty()) {
            error.add(1);
            lb_error2.setText("กรุณาเลือกวัน");
        } else {
            lb_error2.setText("");
        }
        if (txt_opdStop.getText().isEmpty()) {
            error.add(1);
            lb_error3.setText("กรุณาเลือกวัน");
        } else {
            lb_error3.setText("");
        }
        if (txt_begin_money.getText().isEmpty()) {
            error.add(1);
            lb_error6.setText("กรุณากรอกจำนวนเงินตั้งต้น");
        } else {
            lb_error6.setText("");
        }        
        if (comboStmpNoMonth.getSelectedIndex() == 0) {
            error.add(1);
            lb_error8.setText("กรุณาเลือกเดือน");
        } else {
            lb_error8.setText("");
        }
         if (comboStmpNoMonth.getSelectedIndex() > 0 && comboStmpNoRound.getSelectedIndex() ==0) {
            error.add(1);
            lb_error7.setText("กรุณาเลือกเลขงวด");
        } else {
            lb_error7.setText("");
        }
        return error;
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCreateData;
    private javax.swing.JButton btn_opdStart;
    private javax.swing.JButton btn_opdStop;
    private javax.swing.JButton btn_sendStart;
    private javax.swing.JButton btn_sendStop;
    private javax.swing.JComboBox comboCreateTable;
    private javax.swing.JComboBox comboStmpNoMonth;
    private javax.swing.JComboBox comboStmpNoRound;
    private javax.swing.JComboBox comboStmpNoYear;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel37;
    private javax.swing.JPanel jPanelOpd;
    private javax.swing.JPanel jPanelSend;
    private javax.swing.JLabel lb_error1;
    private javax.swing.JLabel lb_error2;
    private javax.swing.JLabel lb_error3;
    private javax.swing.JLabel lb_error4;
    private javax.swing.JLabel lb_error5;
    private javax.swing.JLabel lb_error6;
    private javax.swing.JLabel lb_error7;
    private javax.swing.JLabel lb_error8;
    private javax.swing.JLabel lb_error9;
    private javax.swing.ButtonGroup rGroupIndv_late;
    private javax.swing.ButtonGroup rGroupOpae74_Option;
    private javax.swing.ButtonGroup rGroupRefer_Option;
    private javax.swing.ButtonGroup rGroup_Process;
    private javax.swing.JTextField txt_begin_money;
    private javax.swing.JTextField txt_opdStart;
    private javax.swing.JTextField txt_opdStop;
    private javax.swing.JTextField txt_sendStart;
    private javax.swing.JTextField txt_sendStop;
    private javax.swing.JComboBox txt_stmp_no;
    // End of variables declaration//GEN-END:variables
}
